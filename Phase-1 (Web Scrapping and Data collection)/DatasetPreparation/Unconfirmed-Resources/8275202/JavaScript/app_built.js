!function(){angular.module("lbpCommon",["ui.bootstrap","ngResource","ui.utils","ngMessages","ngAutocomplete","ngMask"]).constant("GOOGLE_EVENTS",{CAT_UI_PROGRESS:"UIProgress",CAT_UI_PROGRESS_ENQ:"UIProgressEnquiry",CAT_UI_ERROR:"UIError",CAT_UI_ERROR_ENQ:"UIErrorEnquiry",CAT_APP_ERROR:"AppError",CAT_APP_ERROR_ENQ:"AppErrorEnquiry",CAT_GOAL:"Conversion",CAT_MISC:"Misc",ACT_APP_COMPLETE:"AppCompleted",ACT_APP_START:"AppLoaded",ACT_GENERAL_DONE:"GeneralDone",ACT_PERSONAL_DONE:"PersonalDone",ACT_ADD_COBORROWER:"AddedCoBorrower",ACT_ADDRESS_DONE:"AddressDone",ACT_EMPLOYMENT_DONE:"EmploymentDone",ACT_BUDGET_DONE:"BudgetDone",ACT_BANK_DONE:"BankDone",ACT_ERR_DOB:"FailedDOB",ACT_ERR_ADDRESS:"FailedAddress",ACT_ERR_SERVER:"FailedSaving",ACT_ENQ_BUS_COMPLETED:"EnquiryCompletedBusiness",ACT_ENQ_DEBT_COMPLETED:"EnquiryCompletedDebt",ACT_ENQ_HOM_COMPLETED:"EnquiryCompletedHome",LBL_APP_LOADED:"Application loaded",LBL_ENQ_LOADED:"Enquiry loaded",LBL_APP_COMPLETED:"Application completed",LBL_COMPLETED_GENERAL:"Completed general info",LBL_SAVED_GENERAL:"Saved general info",LBL_COMPLETED_PERSONAL:"Completed personal info",LBL_COMPLETED_CO_PERSONAL:"Completed co-borrower info",LBL_COMPLETED_ADDRESSES:"Completed addresses info",LBL_COMPLETED_EMPLOYMENT:"Completed employment info",LBL_COMPLETED_BUDGET:"Completed budget info",LBL_COMPLETED_BANK:"Completed bank info",LBL_COMPLETED_ENQ:"Enquiry successfully completed",LBL_ERR_DATE_FORMAT:"Invalid format",LBL_ERR_DOB:"Invalid DOB age",LBL_ERR_NO_ADDRESS_GOOGLE:"Google address not found",LBL_ERR_PARTIAL_ADDRESS_GOOGLE:"Google address partially found"}).config(["$locationProvider",function(a){a.html5Mode(!0)}])}();;
!function(){angular.module("loanApp",["ui.bootstrap","ui.bootstrap.fontawesome","ngResource","ui.utils","ngMessages","ngAutocomplete","ngMask","lbpCommon","ui.bootstrap-slider"]).constant("GOOGLE_EVENTS",{CAT_UI_PROGRESS:"UIProgress",CAT_UI_ERROR:"UIError",CAT_APP_ERROR:"AppError",CAT_GOAL:"Conversion",CAT_MISC:"Misc",ACT_APP_COMPLETE:"AppCompleted",ACT_APP_START:"AppLoaded",ACT_GENERAL_DONE:"GeneralDone",ACT_PERSONAL_DONE:"PersonalDone",ACT_ADD_COBORROWER:"AddedCoBorrower",ACT_ADDRESS_DONE:"AddressDone",ACT_EMPLOYMENT_DONE:"EmploymentDone",ACT_BUDGET_DONE:"BudgetDone",ACT_BANK_DONE:"BankDone",ACT_ERR_DOB:"FailedDOB",ACT_ERR_ADDRESS:"FailedAddress",ACT_ERR_SERVER:"FailedSaving",ACT_WARN_SHOWN:"WarningShown",LBL_APP_LOADED:"Application loaded",LBL_APP_COMPLETED:"Application completed",LBL_COMPLETED_GENERAL:"Completed general info",LBL_SAVED_GENERAL:"Saved general info",LBL_WARNING_SHOWN:"Government warning shown",LBL_COMPLETED_PERSONAL:"Completed personal info",LBL_COMPLETED_CO_PERSONAL:"Completed co-borrower info",LBL_COMPLETED_ADDRESSES:"Completed addresses info",LBL_COMPLETED_EMPLOYMENT:"Completed employment info",LBL_COMPLETED_BUDGET:"Completed budget info",LBL_COMPLETED_BANK:"Completed bank info",LBL_ERR_DATE_FORMAT:"Invalid format",LBL_ERR_DOB:"Invalid DOB age",LBL_ERR_NO_ADDRESS_GOOGLE:"Google address not found",LBL_ERR_PARTIAL_ADDRESS_GOOGLE:"Google address partially found"}).config(["$locationProvider",function(a){a.html5Mode(!0)}])}();;
!function(){angular.module("enqApp",["ui.bootstrap","ui.bootstrap.fontawesome","ngResource","ui.utils","ngMessages","ngMask","lbpCommon"]).config(["$locationProvider",function(a){a.html5Mode(!0)}])}();;
!function(){var a=angular.module("lbpCommon");a.factory("commonSvc",["$log","bootstrappedData","logRepository",function(a,b,c){var d=function(d,e){try{e.keen={timestamp:(new Date).toISOString()},e.clientIp=b.ip,b.isTest&&(d=-1!=b.ip.indexOf("127.0")?"dev."+d:"test."+d);var f=e.message;null==e.message&&(f=JSON.stringify(e));try{var g={error:e.error,data:d+" : "+f,environment:e.fullScope,trace:e.history},h=c.saveLog(g);if(""===h||null==h.$promise)return;h.$promise.then(function(b){a.info("saved log to server "+JSON.stringify(b))},function(b){a.error("Failed to send log to server: \n"+b)})}catch(i){a.error("Failed on sending message to server: \n"+i)}}catch(i){a.error("Failed on sending message to server: \n"+i)}},e=function(b,c){return null==b?(a.error("Form is null"),""):null==c?(a.error("Field is null"),""):{"has-success":c.$valid&&(c.$dirty||b.$submitted),"has-error":c.$invalid&&(c.$dirty||b.$submitted)}},f=function(a,b){return b.$touched&&b.$dirty||a.$submitted},g=function(b){a.error(h(b))},h=function(a){var b=[];return angular.forEach(a.$error,function(c,d){angular.isArray(c)&&angular.forEach(c,function(c){null!=c&&b.push("Form '"+a.$name+"' field '"+c.$name+"' failed '"+d+"'. Model value '"+c.$modelValue+"' View value '"+c.$viewValue)})}),b},i=function(a){return null==a||"[object Date]"!=Object.prototype.toString.call(a)?a:new Date(a.getTime()-6e4*a.getTimezoneOffset())},j=function(a,b){for(var c=0;c<a.length;c++)if(a[c].value==b)return a[c].text;return""},k=function(a,c,d){"undefined"!=typeof ga&&(b.isTest&&(a="test."+a),ga("send","event",a,c,d))},l=function(a,b){var c=b[a];return c},m=function(a){return angular.isUndefined(a)||""===a||null===a||a!==a};return{holdingCointainerClass:e,errorsVisible:f,logFormErrors:g,getLookupValue:j,getHint:l,getFormErrors:h,sendGoogleEvent:k,adjustDateTimeZone:i,logEvent:d,isEmpty:m}}])}();;
!function(){var a=angular.module("lbpCommon");a.factory("formsSvc",["$log","commonSvc",function(a,b){var c={general:null,address:null,employment:null,budget:null,bank:null,enquiry:null},d=function(){for(var a in c)if(null!=c[a])return c[a].$root.appHistory;return[]},e=function(a,b){var c={};c[a.title]=b,void 0!=a.$root.appHistory&&a.$root.appHistory.push(c)},f=function(a,b){c[a]=b},g=function(){var a={};for(var b in c)null!=c[b]&&(a[b]=c[b].model);return a},h=function(a){return null!=c[a]&&null!=c[a].formConfig?c[a].htmlForm:null},i=function(a){return null!=c[a]?c[a]:null},j=function(c,d,f){var g=i(c);if(null==g)return b.logEvent("ui.warning",{message:"Attempt to save form "+c+" which has not registered with formsSvc"}),void a.error("Attempt to save form "+c+" which has not registered with formsSvc");if(!g.formConfig.formSaved)if(null!=f&&f(),g.htmlForm.$setValidity("serverSide",!0),g.htmlForm.$setSubmitted(),g.htmlForm.$valid){if(e(g,{message:"Saving valid form"}),g.formConfig.isBeingSaved)return void a.debug("Form is being saved already");g.formConfig.isBeingSaved=!0,a.debug("Saving "+c+" data now"),g.formDisabled=!0,d()}else g.formDisabled=!1,e(g,{message:"Saving form failed. Validation not passed.",errors:b.getFormErrors(g.htmlForm)}),b.logFormErrors(g.htmlForm)},k=function(c,f){var h=i(c);if(null==h)return b.logEvent("ui.warning",{message:"Failed to save form "+c+" which has not registered with formsSvc"}),void a.error("Failed to save "+c+" which has not registered with formsSvc");h.formDisabled=!1,h.formConfig.isBeingSaved=!1,h.formConfig.formSaved=!1,h.htmlForm.$setValidity("serverSide",!1),h.formConfig.serverErrors=f.data;var j={message:"Error saving form "+c,error:f};if(e(h,angular.copy(j)),j.fullScope=g(),j.history=d(),b.logEvent("server.error",j),!b.isEmpty(f.data))for(var k=0;k<f.data.length;k++)-1!=f.data[k].indexOf("Application already completed")&&(e(h,{message:"Detected application already completed condition."}),h.$emit("Global.AppCompleted"));a.error(f),h.formConfig.deferred.reject({err:f})},l=function(b,c,d){var e=i(b);return null==e?void a.error("Attempt to complete saving "+b+" which has not registered with formsSvc"):(d!==!0&&(e.formDisabled=!1),e.formConfig.isBeingSaved=!1,e.formConfig.formSaved=!0,a.debug(b+" saved"),void e.formConfig.deferred.resolve({data:c}))},m=function(c){var d=i(c);return null==d?(b.logEvent("ui.warning",{message:"Attempt to validate form "+c+" which has not registered with formsSvc"}),void a.error("Attempt to validate "+c+" which has not registered with formsSvc")):(d.htmlForm.$setValidity("serverSide",!0),void d.htmlForm.$setSubmitted())};return{getControllerForm:h,registerScope:f,getScope:i,saveForm:j,saveComplete:l,saveFailed:k,getHistory:d,addHistory:e,validateForm:m,getCombinedModel:g}}])}();;
!function(){var a=angular.module("lbpCommon");a.factory("lookupSvc",["$http","$resource","bootstrappedData",function(a,b,c){var d=function(){return a.get(c.apiLocation+"api/common/titles").then(function(a){return a.data})},e=function(a,d){return b(c.apiLocation+"api/common/location/:state/:postcode",{state:a,postcode:d}).query()},f=function(){return b(c.apiLocation+"api/common/referring-sources").query()},g=function(){return b(c.apiLocation+"api/common/purposes").query()},h=function(){return b(c.apiLocation+"api/common/time-at-address").query()},i=function(){return b(c.apiLocation+"api/common/board-rent-type").query()},j=function(){return b(c.apiLocation+"api/common/employment-type").query()},k=function(){return b(c.apiLocation+"api/common/expense-type").query()},l=function(){return b(c.apiLocation+"api/common/budget-frequency").query()},m=function(a){return b(c.apiLocation+"api/common/country-states/:textOnly",{textOnly:a}).query()},n=function(a){return b(c.apiLocation+"api/common/repayments/:loanType",{loanType:a}).query()},o=function(){return b(c.apiLocation+"api/common/calltimes").query()},p=function(){return b(c.apiLocation+"api/common/marital-statuses").query()};return{getCountryStates:m,getCallTimes:o,getMaritalStatuses:p,getTitles:d,getLocation:e,getRepayments:n,getReferringSources:f,getLoanPurposes:g,getTimeAtPlaceList:h,getBoardRentTypeList:i,getBudgetFrequencyList:l,getExpenseTypeList:k,getEmploymentTypeList:j}}])}();;
!function(){var a=angular.module("lbpCommon");a.factory("seoSvc",function(){return{getGoogleAnalyticsId:function(a){getAnalyticsUid(a)},getGoogleClickId:function(){var a=getGclId();return a},getKeywords:function(){var a=getKeywords();return a},getWebReferrer:function(){var a=getHttpReferrer();return a},getSearchTerm:function(){var a=getSearchTerm();return a},sendMouseflowFormAttempt:function(a){try{window._mfq=window._mfq||[],window._mfq.push(["formSubmitAttempt",a])}catch(b){}},sendMouseflowFormFailure:function(a){try{window._mfq=window._mfq||[],window._mfq.push(["formSubmitFailure",a])}catch(b){}},sendMouseflowFormSuccess:function(a){try{window._mfq=window._mfq||[],window._mfq.push(["formSubmitSuccess",a])}catch(b){}}}})}();;
!function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}var b=angular.module("lbpCommon");b.config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","$injector",function(a,b){return function(c,d){var e=b.get("$rootScope"),f=b.get("formsSvc");void 0==f||isNaN(f)||f.addHistory(e,{message:"Exception: "+c});var g=b.get("commonSvc");void 0!=g&&isNaN(g)&&g.logEvent("error.unhandled",c),a(c,d)}}])}]),b.config(["$provide",function(a){a.decorator("uibDatepickerPopupDirective",["$delegate",function(a){var b=a[0],c=b.link;return b.compile=function(){return function(a,b){c.apply(this,arguments),b.inputmask("99/99/9999",{placeholder:"DD/MM/YYYY"})}},a}])}]),b.directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){b.$watch(d.ngMin,function(){e.$isDirty&&e.$setViewValue(e.$viewValue)});var f=function(c){var f=b.$eval(d.ngMin+"")||0;return!a(c)&&f>c?void e.$setValidity("ngMin",!1):(e.$setValidity("ngMin",!0),c)};e.$parsers.push(f),e.$formatters.push(f)}}}),b.directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){b.$watch(d.ngMax,function(){e.$isDirty&&e.$setViewValue(e.$viewValue)});var f=function(c){var f=b.$eval(d.ngMax+"")||1/0;return!a(c)&&c>f?void e.$setValidity("ngMax",!1):(e.$setValidity("ngMax",!0),c)};e.$parsers.push(f),e.$formatters.push(f)}}}),b.directive("ngBlur",["$parse",function(a){return function(b,c,d){var e=a(d.ngBlur);c.bind("blur",function(a){void 0!==b.timeout?b.timeout(function(){e(b,{$event:a,target:c})}):b.$apply(function(){e(b,{$event:a,target:c})})})}}])}();;
!function(){var a=angular.module("lbpCommon");a.factory("logRepository",["$resource","bootstrappedData",function(a,b){return{saveLog:function(c){if(null==c||"test.error.unhandled : undefined"===c.data)return"";var d=a(b.apiLocation+"api/log/error").save(c);return d}}}])}();;
!function(){var a=angular.module("lbpCommon");a.controller("PageController",["$scope","formsSvc","commonSvc","$anchorScroll","$location","$timeout","$window","$uibModal","bootstrappedData",function(a,b,c,d,e,f,g,h,i){a.title="PageController",a.pageSections=[{title:"General Information",content:"Some content"}],a.openedForms={general:!1,address:!1,employment:!1,budget:!1},a.showLeaveWarning=function(){a.modalInstance=h.open({templateUrl:i.apiLocation+"templates/leaveWarning.html",size:"lg",keyboard:!0,windowClass:"z1080",scope:a})},a.cancelLeave=function(){a.modalInstance.dismiss("cancel")},g.addEventListener("beforeunload",function(b){return a.handleClose(b)}),g.addEventListener("pagehide",function(b){return a.handleClose(b)}),g.addEventListener("unload",function(b){return a.handleClose(b)}),a.handleClose=function(b){return a.appStarted()&&!a.applicationSaved?(a.showLeaveWarning(),b.preventDefault(),b.returnValue="You have not completed your application","You have not completed your application"):null},a.formsReady=function(d,e){try{if("bank"===e&&(null==a.$root.bankUrl||0===a.$root.bankUrl.length))return!1;if(null!=e&&a.openedForms[e]&&null!=b.getControllerForm(e)&&b.getControllerForm(e).$dirty)return!0;var f=!0,g=null!=b.getControllerForm(e)&&b.getControllerForm(e).$dirty;if(angular.forEach(d,function(a){var c=b.getControllerForm(a);(null==c||c.$invalid||c.$pristine&&!c.$submitted)&&(f=!1)}),f?a.openedForms[e]=!0:g||(a.openedForms[e]=!0),f&&"bank"===e){var h=a.$root.accomodationType;if(null==h||0===h.length||-1===h.toLowerCase().indexOf("own")){var i=b.getControllerForm("budget");(null==i||i.$invalid||i.$pristine&&!i.$submitted)&&(f=!1)}}return f}catch(j){c.logEvent("ui.error.page-ctrl.forms-ready.fault",{message:"FormsReady() failed for  "+JSON.stringify(d)+", form: "+e+" error: "+JSON.stringify(j)})}},a.formDisabled=!1,a.applicationSaved=!1,a.partialCompletion=void 0!==e.search().partial,a.getHint=function(b,d){return d?"":c.getHint(b,a.hints)},a.setPageState=function(c,d){if(null!=d&&d.length>0){var e=b.getScope(d);return void(e.formDisabled=c)}var f=b.getScope("general"),g=b.getScope("address"),h=b.getScope("employment"),i=b.getScope("budget"),j=b.getScope("bank");f.formDisabled=c,g.formDisabled=c,h.formDisabled=c,i.formDisabled=c,j.formDisabled=c,a.formDisabled=c},a.isFormDisabled=function(a){var c=b.getScope(a);return c.formDisabled},a.showCompleted=function(){b.addHistory(a,{message:"Showing completed message"})},a.ignoreCenterlink=function(){a.ignoreCenterlinkOnly=!0,a.submitApplication()},a.centerlinkOnly=function(){a.centerlinkOnlyIncome=!0,a.applicationSaved=!0,a.setPageState(!0);var c=b.getScope("bank");f(function(){c.process("",a.$root.borrowerName,18,a.$root.isZdh,"#apply")})},a.showTermsError=!1,a.submitApplication=function(){if(a.showTermsError=!1,!a.termsAgree)return void(a.showTermsError=!0);b.validateForm("budget"),b.validateForm("bank");var c=b.getScope("general"),d=b.getScope("address"),e=b.getScope("employment"),f=b.getScope("budget"),g=b.getScope("bank");if(!c.isPastClient()&&e.isCenterLinkOnly()&&!a.ignoreCenterlinkOnly)return a.showCenterlinkError=!0,void(a.$root.showCenterlinkError=!0);a.setPageState(!0),c.formConfig.isBeingSaved=!1,d.formConfig.isBeingSaved=!1,e.formConfig.isBeingSaved=!1,f.formConfig.isBeingSaved=!1,g.formConfig.isBeingSaved=!1;var h=c.save();null!=h&&h.then(function(){var a=d.save();null!=a&&a.then(function(){var a=e.save();null!=a&&a.then(function(){var a=f.save();null!=a&&a.then(function(){var a=g.save();null!=a&&a.then(function(){})})})})})},a.$watch("termsAgree",function(c){if(void 0!==c&&null!=c){var d=b.getScope("general");(a.termsAgree||void 0!==d&&null!==d&&d.htmlForm.$dirty)&&(a.showTermsError=!c)}}),a.validateGeneral=function(){a.isFormDisabled("general")||a.$broadcast("GeneralController.saveGeneralInfo")},a.validateAddress=function(){if(!a.isFormDisabled("address")){var c=b.getScope("general"),d=b.getScope("address");c.save().then(d.save())}},a.validateEmployment=function(){if(!a.isFormDisabled("employment")){var c=b.getScope("general"),d=b.getScope("address"),e=b.getScope("employment");c.save().then(d.save().then(e.save))}},a.validateBudget=function(){if(!a.isFormDisabled("employment")){var c=b.getScope("general"),d=b.getScope("address"),e=b.getScope("employment"),f=b.getScope("budget");c.save().then(d.save().then(e.save().then(f.save)))}},a.appStarted=function(){var a=b.getScope("general");return!a.htmlForm.$pristine},a.validateBank=function(){a.isFormDisabled("bank")||a.submitApplication()},a.$root.showCenterlinkError=!1,a.$root.applicationKey="",a.$root.principalKey="",a.$root.coBorrowerKey="",a.$root.borrowerName="",a.$root.borrowerPhone="",a.$root.referenceNo="",a.$root.referringSource=null,a.$root.bankUrl="",a.$root.isCompleted=!1,a.$root.loanType="",a.$root.appHistory=[],a.$root.borrowerAge=null,a.$root.coBorrowerAge=null,a.$root.hasCoBorrower=!1,a.$root.hasCenterlink=!1,a.$root.isPastClient=!1,a.$root.isZdh=!1,a.termsAgree=!1,a.ignoreCenterlinkOnly=!1,a.centerlinkOnlyIncome=!1,a.hints={completeAbove:"Please complete information above. Once done this section will expand automatically"},a.$on("Global.ApplicationClientKeySet",function(c,d){b.addHistory(a,{message:"Setting applicationKey to "+d}),a.$root.applicationKey=d}),a.$on("Global.HasCenterlink",function(c,d){b.addHistory(a,{message:"Setting hasCenterlink to "+d});var e=b.getScope("bank");e.setHasCenterlink(d)}),a.$on("Global.BankUrlSet",function(c,d){b.addHistory(a,{message:"Setting bank url to "+d}),a.$root.bankUrl=d;var e=b.getScope("bank");e.setUrl(d)}),a.$on("Global.PrincipalKeySet",function(c,d){b.addHistory(a,{message:"Setting principal Key to "+d}),a.$root.principalKey=d}),a.$on("Global.IsPastClient",function(c,d){a.$root.isPastClient=d;var e=b.getScope("employment");null!=e&&e.pastClient(d)}),a.$on("Global.ReferringSource",function(c,d){a.$root.referringSource=d;var e=b.getScope("employment");null!=e&&e.setSource(d)}),a.$on("Global.CoBorrowerKeySet",function(c,d){b.addHistory(a,{message:"Setting co-borrower Key to "+d}),a.$root.coBorrowerKey=d}),a.$on("Global.BorrowerNameSet",function(c,d){b.addHistory(a,{message:"Setting borrower name to "+d}),a.$root.borrowerName=d}),a.$on("Global.BorrowerPhoneSet",function(c,d){b.addHistory(a,{message:"Setting borrower phone to "+d}),a.$root.borrowerPhone=d}),a.$on("Global.BorrowerAgeSet",function(b,c){a.$root.borrowerAge=c}),a.$on("Global.CoBorrowerAgeSet",function(b,c){a.$root.coBorrowerAge=c}),a.$on("Global.HasCoBorrowerSet",function(b,c){a.$root.hasCoBorrower=c}),a.$on("Global.LoanTypeSet",function(c,d){b.addHistory(a,{message:"Setting loan type to "+d}),a.$root.loanType=d}),a.$on("Global.IsZdhSet",function(b,c){a.$root.isZdh=c}),a.$on("Global.AccomodationTypeSet",function(b,c){a.$root.accomodationType=c}),a.testComplete=function(){a.applicationSaved=!a.applicationSaved,e.hash("apply"),d()},a.$on("Global.BudgetSaved",function(c,d){b.addHistory(a,{message:"Budget saved, reference no "+d.confirmationNo})}),a.$on("Global.BankSaved",function(c,d){b.addHistory(a,{message:"Bank saved, reference no "+d.confirmationNo}),a.applicationSaved=!0,a.$root.referenceNo=d.confirmationNo,a.setPageState(!0);var e=b.getScope("finish");e.process(a.$root.referenceNo,a.$root.borrowerName,a.$root.borrowerAge>a.$root.coBorrowerAge?a.$root.borrowerAge:a.$root.coBorrowerAge,a.$root.isZdh,d.redirectUrl,d.needBankInfo)}),a.$on("Global.AppCompleted",function(){b.addHistory(a,{message:"Application completed event has been raised"}),a.$root.isCompleted=!0,a.showCompleted(),a.setPageState(!0)}),a.$on("Global.StartedOnAddress",function(){b.addHistory(a,{message:"Started on Address event raised"}),a.validateGeneral()}),a.$on("Global.StartedOnEmployment",function(){b.addHistory(a,{message:"Started on Employment event raised"}),a.validateAddress()}),a.$on("Global.StartedOnBudget",function(){b.addHistory(a,{message:"Started on Budget event raised"}),a.validateEmployment()}),a.$on("Global.StartedOnBank",function(){b.addHistory(a,{message:"Started on Bank event raised"}),a.validateBudget()})}])}();;
!function(a){setSearchCookie=function(){var a=getSearchTerm(),b=document.referrer,c=getGclId(),d=getKeywords(),e=86400,f="?";-1===document.cookie.indexOf("google-clickid")&&c&&c.length>0&&(document.cookie="google-clickid="+encodeURIComponent(c)+"; path=/; max-age="+e+";"),null!=c&&c.length>0&&(f+="clickId="+encodeURIComponent(c)+"&"),-1===document.cookie.indexOf("original-referrer")&&b&&b.length>0&&(document.cookie="original-referrer="+encodeURIComponent(b)+"; path=/; max-age="+e+";"),null!=b&&b.length>0&&(f+="referrer="+encodeURIComponent(b)+"&"),-1===document.cookie.indexOf("keywords")&&d&&d.length>0&&(document.cookie="keywords="+encodeURIComponent(d)+"; path=/; max-age="+e+";"),null!=d&&d.length>0&&(f+="keywords="+encodeURIComponent(d)+"&"),a&&a.length>0&&(document.cookie="search-phrase="+encodeURIComponent(a)+"; path=/; max-age="+e+";",f+="search-term="+encodeURIComponent(a)),updateMemberLinks(f),"undefined"!=typeof dataLayer&&dataLayer.push(a&&a.length>0&&(-1!==a.indexOf("facebook")||-1!==a.indexOf("fb"))?{event:"fb_origin"}:b&&b.length>0&&-1!==b.indexOf("facebook")?{event:"fb_origin"}:{event:"unknown_origin"})},updateMemberLinks=function(a){if(null!=a&&0!=a.length){a=a.replace(/(&$)/g,"");var b=document.getElementsByClassName("member-link");if(null!=b&&0!=b.length)for(var c=0;c<b.length;c++)href=b[c].getAttribute("href"),b[c].setAttribute("href",href+a)}},cookieToQuery=function(){var a=getSearchTerm(),b=getHttpReferrer(),c=getGclId(),d=getKeywords(),e="?search-term="+encodeURIComponent(a)+"&clickId="+encodeURIComponent(c)+"&keywords="+encodeURIComponent(d)+"&referrer="+encodeURIComponent(b);return e},retrieveAnalyticsId=function(a){try{"undefined"!=typeof ga?(ga("create","UA-34239960-1","auto"),ga(function(b){var c=b.get("clientId");a(c)})):a("ERR: ga is not found")}catch(b){a("ERR:"+b)}},getAnalyticsUid=function(a){var b=getCookie("_ga",document.cookie,";");if(b&&b.length>0){var c=b.split(".");if(c.length>2)return void a(c[c.length-2]+"."+c[c.length-1])}retrieveAnalyticsId(a)},getHttpReferrer=function(){var a=getCookie("original-referrer",document.cookie,";");return a&&a.length>0?a=decodeURIComponent(a):document.referrer},getSearchTerm=function(){var a="",b=getCookie("search-phrase",document.cookie,";"),c=!(null==b||void 0==b||0==b.length);if(document.referrer){var d=getUrlVars(document.referrer);void 0!==d&&null!=d&&void 0!==d.q&&d.q.length>0&&(a="|query: "+d.q+"|")}var e=getQueryStringParameterByName("utm_term");(void 0===e||0==e.length)&&(e=getQueryStringParameterByName("q")),(void 0===e||0==e.length)&&(e=getQueryStringParameterByName("kw"));var f=getQueryStringParameterByName("utm_campaign");(void 0===f||0==f.length)&&(f=getQueryStringParameterByName("ca"));var g=getQueryStringParameterByName("utm_source");(void 0===g||0==g.length)&&(g=getQueryStringParameterByName("se")),(void 0===g||0==g.length)&&(g=getQueryStringParameterByName("src"));var h=getQueryStringParameterByName("utm_medium"),i=getCookie("__utmz",document.cookie,";");if(!c&&(void 0!==i||null!=i)){var j=i.split(".");if(j.length>4){var k=j[4].split("|"),l=!1;k[0].indexOf("gclid")>=0&&(l=!0),l?((void 0===g||0==g.length)&&(g="google"),(void 0===f||0==f.length)&&(f=unescape(k[1].split("=")[1])),(void 0===h||0==h.length)&&(h="(not%20set)"==k[2].split("=")[1]?"cpc":unescape(k[2].split("=")[1])),4!=k.length||void 0!==e&&0!=e.length||(e=unescape(k[3].split("=")[1]))):((void 0===g||0==g.length)&&(g=unescape(k[0].split("=")[1])),(void 0===f||0==f.length)&&(f=unescape(k[1].split("=")[1])),(void 0===h||0==h.length)&&(h=unescape(k[2].split("=")[1])),4!=k.length||void 0!==e&&0!=e.length||(e=unescape(k[3].split("=")[1])))}}return null!=g&&0!=g.length||null!=f&&0!=f.length||null!=h&&0!=h.length||null!=e&&0!=e.length?a=a+"| source: "+g+"| campaign: "+f+"| medium: "+h+"| keyword: "+e:c?b=decodeURIComponent(b):a},getGclId=function(){var a=getQueryStringParameterByName("gclid");if(a.length>0)return a;var b=getCookie("google-clickid",document.cookie,";");if(b&&b.length>0)return b=decodeURIComponent(b);var c=getCookie("__utmz",document.cookie,";"),a="";if(void 0!==c&&null!=c&&c.length>0){var d=c.split("."),e=d[4].split("|");e[0].indexOf("gclid")>=0&&(a=e[0])}return a},getKeywords=function(){var a=getQueryStringParameterByName("keyword");if(a.length>0)return a;var b=getCookie("keywords",document.cookie,";");return b&&b.length>0?b=decodeURIComponent(b):""},getQueryStringParameterByName=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))},getCookie=function(a,b,c){var d,e,f,g=b.split(c);for(d=0;d<g.length;d++)if(e=g[d].substr(0,g[d].indexOf("=")),f=g[d].substr(g[d].indexOf("=")+1),e=e.replace(/^\s+|\s+$/g,""),e==a)return unescape(f);return""},getUrlVars=function(a){var b,c=[];if(!a||0===a.length||-1===a.indexOf("?"))return c;for(var d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)b=d[e].split("="),c.push(b[0]),c[b[0]]=b[1];return c},showPopover=function(b,c,d){var e=a(d).data("bs.popover");void 0==e?a(d).popover({content:b,container:"body",trigger:"manual",title:c,placement:"auto top"}).popover("show"):(e.options.content=b,e.options.title=c,a(d).popover("show"))},applyButtonClick=function(){if(a("#apply").length>0)return scrollTo("#apply"),!1;var b="/apply/mini-loan";window.location.search.length>0&&(b+=window.location.search);var c=getHttpReferrer();if(c.length>0){var d="?";-1!=b.indexOf("?")&&(d="&"),b+=d+"webReferrer="+encodeURIComponent(c)}window.location.href=b},getUrlVars=function(a){var b,c=[];if(-1==a.indexOf("?"))return c;for(var d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)b=d[e].split("="),c.push(b[0]),c[b[0]]=b[1];return c},scrollTo=function(b){a("html, body").animate({scrollTop:a(b).offset().top},300,function(){})},googleNoCallback=function(b,c){a("a[href*=1300661991]").each(function(d,e){a(e).attr("href","tel:"+c),a(e).text(b)})}}(jQuery);;
!function(a){getValidationElementValue=function(b){var c=a(b).is("input")&&"CHECKBOX"==a(b).attr("type").toUpperCase()?a(b).attr("checked")?"True":"False":a(b).is("input")&&"RADIO"==a(b).attr("type").toUpperCase()?a("input:radio[id="+b.id+"]:checked").val():a(b).val();return c},initCalculator=function(b,c,d){var e="",f=0,g="";switch(b){case"mini-loan":f=0,g="Mini Loan ";break;case"car-loan":e="",f=1,g="Motor Vehicle Loan ";break;case"holiday":f=3;break;case"BusinessLoan":f=2,g="Business Loan "}var h=[{loanTypeId:f,activeLoanType:b,finePrintExtra:e,loanName:g}],i=document.getElementById(c);i&&(a("#calculatorTemplate").tmpl(h).appendTo(i),loadRepayments(f,d))},loadRepayments=function(b,c){var d=null,e=c+"/common/repayment/"+b;a.ajax({type:"GET",url:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(c){d=c.data,initSlider(a("#calc-"+b+" .slider"),d,b)},error:function(a){},complete:function(){},async:!0})},initSlider=function(b,c,d){var e=0,f=c.length-1,g=1,h=0;if(void 0!==getQueryStringParameterByName&&""!==getQueryStringParameterByName("amount"))for(var i=parseInt(getQueryStringParameterByName("amount")),j=0;j<c.length;j++)c[j].amount>=i&&0===h&&(h=j);a("#label-min-"+d).html(formatAmount("$"+c[0].amount)),a("#label-max-"+d).html(formatAmount("$"+c[c.length-1].amount)),b.slider({value:h,min:e,max:f,tooltip:"always",step:g,formatter:function(a){return formatAmount("$"+c[a].amount)}}).on("slideStop",function(a){updateTerms(c[a.value],d)}),updateTerms(c[h],d),a("input[name=term-"+d+"]").change(function(){setRepayment(this,d)})},setRepayment=function(b,c){var d=JSON.parse(a("#calcData-"+c).val()),e=0,f=0;b&&"S"!=b.value?(e=Math.round(d.term[1].term/52*12).toFixed(0),f=d.term[1].repayment*d.term[1].term,a(".repayment[data-loantype="+c+"]").html("$"+d.term[1].repayment),a(".calc-term-"+c).html(d.term[1].term+" weeks"),a(".calc-repay-"+c).html("$"+d.term[1].repayment),a("input[name=term-"+c+"]").filter('[value="E"]').attr("checked","checked"),a("input[name=term-"+c+"]").filter('[value="S"]').removeAttr("checked"),updateAppTerms(d.term[1],c)):(e=Math.round(d.term[0].term/52*12).toFixed(0),f=d.term[0].repayment*d.term[0].term,a(".repayment[data-loantype="+c+"]").html("$"+d.term[0].repayment),a(".calc-term-"+c).html(d.term[0].term+" weeks"),a(".calc-repay-"+c).html("$"+d.term[0].repayment),a("input[name=term-"+c+"]").filter('[value="S"]').attr("checked","checked"),a("input[name=term-"+c+"]").filter('[value="E"]').removeAttr("checked"),updateAppTerms(d.term[0],c))},updateAppTerms=function(a,b){try{if(void 0!=angular){var c=2===b?"[ng-controller=EnquiryController]":"[ng-controller=GeneralController]";angular.element(c).length>0&&void 0!=angular.element(c).scope()&&angular.element(c).scope().updateTerms(a)}}catch(d){}},updateTerms=function(b,c){a("#calcData-"+c).val(JSON.stringify(b)),a("input[name=term-"+c+"]").filter('[value="E"]').attr("checked",!1),a("input[name=term-"+c+"]").filter('[value="S"]').attr("checked",!0),a("input[name=term-"+c+"]").filter('[value="E"]').parent().removeClass("active"),a("input[name=term-"+c+"]").filter('[value="S"]').parent().addClass("active"),b.term.length>1?a("#term-"+c+"2").parent().removeClass("vis-hidden"):a("#term-"+c+"2").parent().addClass("vis-hidden");var d=formatAmount("$"+b.amount);a(".calc-amount-"+c).html(d),setRepayment(null,c);try{if(void 0!=angular){var e=2===c?"[ng-controller=EnquiryController]":"[ng-controller=GeneralController]";if(angular.element(e).length>0&&void 0!=angular.element(e).scope()){angular.element(e).scope().updateAmount(b.amount);var f="checked"==a("input[name^=term-]").filter('[value="S"]').attr("checked")?0:1;1==f&&1==calcData.term.length&&(f=0),angular.element(e).scope().updateTerms(b.term[f])}}}catch(g){}},applyCalcClick=function(){if(-1===window.location.href.indexOf("/lp/"))return scrollTo("#apply"),!1;var b="";window.location.search.length>0&&(b="&"+window.location.search.substring(1));var c=getHttpReferrer(),d=JSON.parse(a("[id^=calcData]").val()),e="checked"==a("input[name^=term-]").filter('[value="S"]').attr("checked")?0:1;1==e&&1==d.term.length&&(e=0);var f="/apply/loan?amount="+d.amount+"&term="+d.term[e].term+"&repayment="+d.term[e].repayment+b;c.length>0&&(f+="&webReferrer="+encodeURIComponent(c)),window.location.href=f},formatAmount=function(a){return a.length>4?a.substring(0,a.length-3)+","+a.substring(a.length-3):a}}(jQuery);;
!function(){var a=angular.module("loanApp");a.controller("AddressController",["$scope","formsSvc","commonSvc","lookupSvc","$q","$log","$timeout","addressRepository","seoSvc","GOOGLE_EVENTS",function(a,b,c,d,e,f,g,h,i,j){b.registerScope("address",a),a.title="AddressController",a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=e.defer(),a.validateAddressesBeforeSave()?a.htmlForm.$valid?(a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.modelAddress}):b.saveForm("address",a.innerSave),a.formConfig.deferred.promise):(a.htmlForm.$setSubmitted(),a.formConfig.deferred.reject({err:"Unable to save address info with invalid data"}),a.formConfig.deferred.promise):(a.formConfig.deferred.reject({err:"Unable to save address with invalid data"}),a.htmlForm.$setValidity("serverSide",!1),a.formConfig.deferred.promise)},a.innerSave=function(){if(i.sendMouseflowFormAttempt("#addressForm"),null==a.$root.principalKey||0===a.$root.principalKey.length)f.info("Unable to save address prior to personal info"),a.formConfig.deferred.reject({err:"Unable to save address prior to personal info"});else{var b=h.saveAddress(a.modelAddress,a.$root.applicationKey,a.$root.principalKey);b.$promise.then(a.addressSaved,a.saveFailed)}},a.$on("AddressController.saveAddress",a.save),a.hasCoBorrower=function(){return a.$root.hasCoBorrower},a.addressSaved=function(d){if(a.$root.hasCoBorrower)if(null==a.$root.coBorrowerKey||0===a.$root.coBorrowerKey.length)f.info("Unable to save co address prior to co-borrower info"),a.formConfig.deferred.reject({err:"Unable to save co address prior to co-borrower info"});else{a.fillCoAddress();var e=h.saveAddress(a.modelCoAddress,a.$root.applicationKey,a.$root.coBorrowerKey);e.$promise.then(a.coAddressSaved,a.saveFailed)}else b.saveComplete("address",d);c.sendGoogleEvent(j.CAT_GOAL,j.ACT_ADDRESS_DONE,j.LBL_COMPLETED_ADDRESSES),i.sendMouseflowFormSuccess("#addressForm")},a.validateAddressesBeforeSave=function(){return a.validateAddress(a.modelAddress.currentAddress)&&a.validateAddress(a.modelAddress.previousAddress)&&a.validateAddress(a.modelAddress.postalAddress)&&a.validateAddress(a.modelCoAddress.currentAddress)&&a.validateAddress(a.modelCoAddress.previousAddress)&&a.validateAddress(a.modelCoAddress.postalAddress)},a.validateAddress=function(d){var e=!0;if(!(null!=d.streetAddress&&0!==d.streetAddress.length||null!=d.fullAddress&&0!==d.fullAddress.length||null!=d.state&&0!==d.state.length))return e;var f="";return null==d.locationId&&(f="No location set for address: ",e=!1),(void 0===d.postcode||null==d.postcode||0==d.postcode.length)&&(f="No postcode set for address: ",e=!1),(void 0===d.state||null==d.state||0===d.state.length)&&(f="No state set for address: ",e=!1),e||(d.needManualEntry=!0,b.addHistory(a,{message:"Invalid address attempted for save",value:d.fullAddress,address:d}),c.logEvent("ui.error.address",{error:f+d.fullAddress+" type: "+(d.isCoBorrower?"co-":"")+d.addressType,fullScope:b.getCombinedModel(),history:b.getHistory(),message:"Invalid address attempted for save"})),e},a.coAddressSaved=function(a){b.saveComplete("address",a)},a.initPage=function(b){a.htmlForm=b,a.formConfig.isZdh=a.$root.isZdh},a.saveFailed=function(a){b.saveFailed("address",a),c.sendGoogleEvent(j.CAT_APP_ERROR,j.ACT_ERR_SERVER,"Address saved failed"),i.sendMouseflowFormFailure("#addressForm")},a.fillCoAddress=function(){a.modelCoAddress.isPostalSameAsCurrent=a.modelAddress.isPostalSameAsCurrent,a.modelCoAddress.currentAddress=null,a.modelCoAddress.currentAddress=angular.copy(a.modelAddress.currentAddress),a.modelCoAddress.postalAddress=null,a.modelCoAddress.postalAddress=angular.copy(a.modelAddress.postalAddress),a.formConfig.coBorrowerAtSamePreviousAddress&&(a.modelCoAddress.isPreviousOverseas=a.modelAddress.isPreviousOverseas,a.modelCoAddress.previousAddress=null,a.modelCoAddress.previousAddress=angular.copy(a.modelAddress.previousAddress))},a.holdingCointainerClass=function(a,b){return c.holdingCointainerClass(a,b)},a.errorsVisible=function(a,b){return c.errorsVisible(a,b)},a.getCurrentAddressLabel=function(){var b="Current Address";return null!=a.$root.borrowerName&&a.$root.borrowerName.length>0&&(b=a.$root.borrowerName+", we now need your current residential address"),b},a.stateList=d.getCountryStates(!0),a.timeAtAddressList=d.getTimeAtPlaceList(),a.boardRentTypeList=d.getBoardRentTypeList(),a.hints={postalAddress:"Please select and enter if your postal address is different to your residential address",postalAddressStreet:"Please enter postal street address or PO Box details",coBorrowerAddress:"Co-Borrower previous address is",coZdhBorrowerAddress:"Co-Applicant previous address is",coBorrowerAddressHint:"Type in co-borrowers previous address",coZdhBorrowerAddressHint:"Type in co-applicant previous address",coBorrowerAddressLabel:"Co-Borrower Previous Address",coBorrowerPreviousAddressSameHint:"Click to choose if co-borrower lived at the same previous address or separately",coZdhBorrowerPreviousAddressSameHint:"Click to choose if co-applicant lived at the same previous address or separately",coZdhBorrowerAddressLabel:"Co-Applicant Previous Address",coBorrowerAddressNotFound:"We were unable to automatically locate co-borrower previous address, please use fields below to enter it manually",coZdhBorrowerAddressNotFound:"We were unable to automatically locate co-applicant previous address, please use fields below to enter it manually"},a.formDisabled=!1,a.formConfig={addressOptions:{types:"geocode",country:"au",watchEnter:!0},dateFormat:"dd/MM/yyyy",deferred:null,formSaved:!1,htmlForm:null,serverErrors:[],formError:"Information above is not valid, please correct errors",allowedTimeAtAddressCode:10,coBorrowerAtSamePreviousAddress:!0,isZdh:!1,newApp:!0},a.modelAddress={isCoBorrower:!1,isPostalSameAsCurrent:!0,isPreviousOverseas:!1,currentAddress:{googleResponse:null,fullAddress:"",unit:"",streetAddress:"",state:null,locationId:null,suburbName:"",postcode:"",timeAtAddress:null,boardRentType:null,landLord:null,landLordPhoone:null,needManualEntry:!1,addressType:"current",locationList:[{value:null,text:"",selected:!1}]},postalAddress:null,previousAddress:null,applicationId:0,hasCoBorrower:!1,personClientKey:""},a.modelAddress.postalAddress=angular.copy(a.modelAddress.currentAddress),a.modelAddress.postalAddress.addressType="postal",a.modelAddress.previousAddress=angular.copy(a.modelAddress.currentAddress),a.modelAddress.previousAddress.addressType="previous",a.modelCoAddress=angular.copy(a.modelAddress),a.modelCoAddress.currentAddress.addressType="current",a.modelCoAddress.previousAddress.addressType="previous",a.modelCoAddress.postalAddress.addressType="postal",a.modelCoAddress.isCoBorrower=!0,a.model={config:a.formConfig,address:a.modelAddress,coAddress:a.modelCoAddress},a.getHint=function(b){return a.formConfig.isZdh&&(b=b.replace("Borrower","ZdhBorrower")),c.getHint(b,a.hints)},a.currentFullAddressChanged=function(){a.fullAddressChanged(a.modelAddress.currentAddress)},a.postalFullAddressChanged=function(){a.fullAddressChanged(a.modelAddress.postalAddress)},a.previousFullAddressChanged=function(){a.fullAddressChanged(a.modelAddress.previousAddress)},a.previousFullCoAddressChanged=function(){a.fullAddressChanged(a.modelCoAddress.previousAddress)},a.purgeAddress=function(a){a.googleResponse=null,a.fullAddress="",a.unit="",a.streetAddress="",a.state=null,a.locationId=null,a.suburbName="",a.postcode="",a.timeAtAddress=null,a.boardRentType=null,a.landLord=null,a.landLordPhoone=null,a.needManualEntry=!1,a.locationList=[{value:null,text:"",selected:!1}]},a.fillTest=function(){Math.floor(1e3*Math.random(),2);a.modelAddress.currentAddress.fullAddress="77 Boomerang Crescent, Bundall QLD, Australia",a.modelAddress.currentAddress.unit="1b",a.modelAddress.currentAddress.streetAddress="77 Boomerang Crescent",a.modelAddress.currentAddress.state="QLD",a.modelAddress.currentAddress.locationId=52834,a.modelAddress.currentAddress.suburbName="BUNDALL",a.modelAddress.currentAddress.postcode="4217",a.modelAddress.currentAddress.timeAtAddress=a.timeAtAddressList[a.timeAtAddressList.length-1].value,a.modelAddress.currentAddress.boardRentType=a.boardRentTypeList[1].value,a.modelAddress.currentAddress.landLord=null,a.modelAddress.currentAddress.landLordPhoone=null,a.modelAddress.currentAddress.needManualEntry=!0,a.modelAddress.currentAddress.locationList=[{value:52834,text:"BUNDALL",selected:!0}]},a.togglePostalAddress=function(){a.modelAddress.isPostalSameAsCurrent=!a.modelAddress.isPostalSameAsCurrent,a.modelAddress.isPostalSameAsCurrent&&a.purgeAddress(a.modelAddress.postalAddress)},a.fullAddressChanged=function(a){null==a.googleResponse&&null!=a.fullAddress&&a.fullAddress.length>0&&(a.needManualEntry=!0,c.sendGoogleEvent(j.CAT_UI_ERROR,j.ACT_ERR_ADDRESS,j.LBL_ERR_NO_ADDRESS_GOOGLE))},a.timeout=function(a){g(a)},a.setAddressFromGoogle=function(d,e){g(function(){if(b.addHistory(a,{message:"Setting address from google",value:d,address:null==d?"":e}),null!=d&&null!=d.geometry){e.needManualEntry=!1;for(var g="",h="",i="",k="",l=0;l<d.address_components.length;l++){var m=d.address_components[l];switch(m.types[0]){case"subpremise":k=m.long_name;break;case"street_number":g=m.long_name;break;case"route":h=m.long_name;break;case"locality":i=m.long_name,e.suburbName=m.long_name;break;case"administrative_area_level_1":e.state=m.short_name;break;case"postal_code":e.postcode=m.short_name}}null!=k&&k.length>0&&(e.unit=k),e.streetAddress=null==g||0===g.length?e.fullAddress.substring(0,e.fullAddress.indexOf(i)).replace(/,\s*$/,""):g+" "+h,(void 0===e.streetAddress||void 0===e.postcode||null==e.streetAddress||null==e.postcode||void 0==e.suburbName||void 0==e.state||null==e.suburbName||null==e.state||0===e.suburbName.length||0===e.streetAddress.length||0===e.postcode.length||0===e.state.length)&&(e.needManualEntry=!0,b.addHistory(a,{message:"Failed extracting full info from google response. Setting manual entry flag",value:d.formatted_address,address:e}),c.sendGoogleEvent(j.CAT_UI_ERROR,j.ACT_ERR_ADDRESS,j.LBL_ERR_PARTIAL_ADDRESS_GOOGLE)),f.info("Response from Google "+d.formatted_address)}else e.streetAddress="",b.addHistory(a,{message:"Failed getting google response.",value:d,address:e})})},a.$watch("modelAddress.currentAddress.googleResponse",function(b){a.setAddressFromGoogle(b,a.modelAddress.currentAddress)}),a.$watch("modelAddress.postalAddress.googleResponse",function(b){a.setAddressFromGoogle(b,a.modelAddress.postalAddress)}),a.$watch("modelAddress.previousAddress.googleResponse",function(b){a.setAddressFromGoogle(b,a.modelAddress.previousAddress)}),a.$watch("modelCoAddress.previousAddress.googleResponse",function(b){a.setAddressFromGoogle(b,a.modelCoAddress.previousAddress)}),a.loadLocations=function(a,b,c){null!=a&&a.length>0&&null!=b&&b.length>0?d.getLocation(a,b).$promise.then(function(a){c.locationList=a}):c.locationList=[{value:null,text:"",selected:!1}]},a.fullAddressModelChanged=function(c){null!=c.googleResponse&&-1===c.googleResponse.formatted_address.indexOf(c.fullAddress)&&(c.googleResponse=null,c.streetAddress="",b.addHistory(a,{message:"Changing full address to be different than googles",value:c.fullAddress,address:c}))},a.$watch("modelAddress.currentAddress.fullAddress",function(){a.fullAddressModelChanged(a.modelAddress.currentAddress)}),a.$watch("modelAddress.postalAddress.fullAddress",function(){a.fullAddressModelChanged(a.modelAddress.postalAddress)}),a.$watch("modelAddress.previousAddress.fullAddress",function(){a.fullAddressModelChanged(a.modelAddress.previousAddress)}),a.$watch("modelCoAddress.previousAddress.fullAddress",function(){a.fullAddressModelChanged(a.modelCoAddress.previousAddress)}),a.$watch("modelAddress.currentAddress.state",function(b){a.loadLocations(b,a.modelAddress.currentAddress.postcode,a.modelAddress.currentAddress)}),a.$watch("modelAddress.currentAddress.postcode",function(b){a.loadLocations(a.modelAddress.currentAddress.state,b,a.modelAddress.currentAddress)}),a.$watch("modelAddress.postalAddress.state",function(b){a.loadLocations(b,a.modelAddress.currentAddress.postcode,a.modelAddress.postalAddress)}),a.$watch("modelAddress.postalAddress.postcode",function(b){a.loadLocations(a.modelAddress.postalAddress.state,b,a.modelAddress.postalAddress)}),a.$watch("modelAddress.previousAddress.state",function(b){a.loadLocations(b,a.modelAddress.previousAddress.postcode,a.modelAddress.previousAddress)}),a.$watch("modelAddress.previousAddress.postcode",function(b){a.loadLocations(a.modelAddress.previousAddress.state,b,a.modelAddress.previousAddress)}),a.$watch("modelCoAddress.previousAddress.state",function(b){a.loadLocations(b,a.modelCoAddress.previousAddress.postcode,a.modelCoAddress.previousAddress)}),a.$watch("modelCoAddress.previousAddress.postcode",function(b){a.loadLocations(a.modelCoAddress.previousAddress.state,b,a.modelCoAddress.previousAddress)}),a.checkIfCanSetLocation=function(a,b){g(function(){if(null!=a&&a.length>0&&(1!==a.length||null!=a[0].value)){var c=!1;if(b.suburbName.length>0)for(var d=0;d<a.length;d++)a[d].text.toLowerCase()==b.suburbName.toLowerCase()&&(b.locationId=a[d].value,c=!0);b.needManualEntry=!c}})},a.$watch("modelAddress.currentAddress.locationList",function(b){a.checkIfCanSetLocation(b,a.modelAddress.currentAddress)}),a.$watch("modelAddress.postalAddress.locationList",function(b){a.checkIfCanSetLocation(b,a.modelAddress.postalAddress)}),a.$watch("modelAddress.previousAddress.locationList",function(b){a.checkIfCanSetLocation(b,a.modelAddress.previousAddress)}),a.$watch("modelCoAddress.previousAddress.locationList",function(b){a.checkIfCanSetLocation(b,a.modelCoAddress.previousAddress)}),a.$watch("modelAddress.currentAddress.boardRentType",function(b){if(null!=b){for(var c="",d=0;d<a.boardRentTypeList.length;d++)a.boardRentTypeList[d].value==b&&(c=a.boardRentTypeList[d].text);var e=c.split(" ");0==e[0].indexOf("Pay")?a.$emit("Global.AccomodationTypeSet",e[1]):a.$emit("Global.AccomodationTypeSet",e[0])}}),a.isPreviousAddressRequired=function(){a.formConfig.coBorrowerAtSamePreviousAddress=!a.formConfig.coBorrowerAtSamePreviousAddress,a.formConfig.coBorrowerAtSamePreviousAddress&&(a.modelCoAddress.isPreviousOverseas=a.modelAddress.isPreviousOverseas)},a.isPreviousAddressRequired=function(){return!a.modelAddress.isPreviousOverseas&&null!=a.modelAddress.currentAddress.timeAtAddress&&a.modelAddress.currentAddress.timeAtAddress!=a.formConfig.allowedTimeAtAddressCode},a.isPreviousCoAddressRequired=function(){return!a.modelCoAddress.isPreviousOverseas&&null!=a.modelAddress.currentAddress.timeAtAddress&&a.modelAddress.currentAddress.timeAtAddress!=a.formConfig.allowedTimeAtAddressCode&&!a.formConfig.coBorrowerAtSamePreviousAddress},a.coBorrowerPreviousAddressChange=function(){a.formConfig.coBorrowerAtSamePreviousAddress=!a.formConfig.coBorrowerAtSamePreviousAddress,!a.formConfig.coBorrowerAtSamePreviousAddress&&a.modelAddress.isPreviousOverseas&&(a.modelCoAddress.isPreviousOverseas=!1)},a.$watch("modelAddress",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelCoAddress",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelAddress.currentAddress.timeAtAddress",function(c,d){null==c&&null==d||c!=a.formConfig.allowedTimeAtAddressCode||(b.validateForm("address"),a.purgeAddress(a.modelAddress.previousAddress))}),a.$watch("modelCoAddress.currentAddress.timeAtAddress",function(b,c){null==b&&null==c||b!=a.formConfig.allowedTimeAtAddressCode||a.purgeAddress(a.modelCoAddress.previousAddress)}),a.$watch("modelAddress.previousAddress.fullAddress",function(c,d){!a.hasCoBorrower()&&(null!=c&&c.length>0||null!=d&&d.length>0)&&b.validateForm("address")}),a.$watch("modelCoAddress.previousAddress.fullAddress",function(a,c){(null!=a&&a.length>0||null!=c&&c.length>0)&&b.validateForm("address")})}])}();;
!function(){var a=angular.module("loanApp");a.factory("addressRepository",["$resource","bootstrappedData",function(a,b){return{saveAddress:function(c,d,e){var f=a(b.apiLocation+"api/address/:clientKey/:personClientKey",{clientKey:d,personClientKey:e}).save(c);return f}}}])}();;
!function(){var a=angular.module("loanApp");a.factory("googleMapApiSvc",["$resource","$location",function(){return{getGoogleClickId:function(){var a=getGclId();return a},getWebReferrer:function(){var a=getHttpReferrer();return a},getSearchTerm:function(){var a=getSearchTerm();return a},dummy:function(){}}}])}();;
!function(){var a=angular.module("loanApp");a.controller("BankController",["$scope","formsSvc","commonSvc","$q","$log","bankRepository","GOOGLE_EVENTS","seoSvc","$sce",function(a,b,c,d,e,f,g,h,i){b.registerScope("bank",a),a.title="BankController",a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=d.defer(),a.htmlForm.$valid?(a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.modelBank}):b.saveForm("bank",a.innerSave),a.formConfig.deferred.promise):(a.formConfig.deferred.reject({err:"Unable to save bank with invalid data"}),a.formConfig.deferred.promise)},a.innerSave=function(){var c="";if(null==a.$root.applicationKey||0==a.$root.applicationKey.length)c="Unable to save bank prior to application",e.info(c),a.formConfig.deferred.reject({err:c}),b.saveFailed("bank",c);else if(null==a.$root.principalKey||0==a.$root.principalKey.length)c="Unable to save bank, your personal information is not available. Please give us a call.",e.info(c),a.formConfig.deferred.reject({err:c}),b.saveFailed("bank",c);else{var d=f.saveBank(a.modelBank,a.$root.applicationKey,a.$root.principalKey);d.$promise.then(a.bankSaved,a.saveFailed)}h.sendMouseflowFormAttempt("#bankForm")},a.$on("BudgetController.saveBank",a.save),a.bankSaved=function(c){b.saveComplete("bank",c),a.$emit("Global.BankSaved",c),h.sendMouseflowFormSuccess("#bankForm")},a.getSectionLabelText=function(){var b="To fast-track your application, we need to connect with your bank to view your transactions. Please submit your details via this secure form.";return null!=a.$root.borrowerName&&a.$root.borrowerName.length>0&&(b="Almost there "+a.$root.borrowerName+" – so we can view your transactions, please submit your banking details via this secure form. Once the ‘Success’ message displays, scroll down to ‘Your Consent’. To acknowledge, read and check the box, then hit ‘Submit Application’"),b},a.saveFailed=function(a){c.sendGoogleEvent(g.CAT_APP_ERROR,g.ACT_ERR_SERVER,"Bank failed"),b.saveFailed("bank",a),h.sendMouseflowFormFailure("#bankForm")},a.receiveMessage=function(b){if(null!=b.data)try{var d=JSON.parse(b.data);if("BankStatements"===d.source&&(a.modelBank.trace.push(b.data),"submission_complete"===d.event)){switch(c.logEvent("ui.bank-statement.step",{message:"Bank completed with "+JSON.stringify(b.data)}),a.modelBank.completed=!0,d.status){case"error":case"login_fail":a.modelBank.error="Error - "+d.error_code+": "+d.error_message;break;case"success":scrollTo("#consent")}c.logEvent("ui.bank-statement.full_trace",{message:a.modelBank.trace.join()})}}catch(e){c.logEvent("ui.error.bank-message-parse",{message:"Failed parsing message "+JSON.stringify(b.data)+" with: "+e})}},a.initPage=function(b){a.htmlForm=b,window.addEventListener("message",a.receiveMessage,!1)},a.holdingCointainerClass=function(a,b){return c.holdingCointainerClass(a,b)},a.errorsVisible=function(a,b){return c.errorsVisible(a,b)},a.getHint=function(b){return c.getHint(b,a.hints)},a.setHasCenterlink=function(b){a.formConfig.rawUrl=a.formConfig.rawUrl.replace("withCentrelink=true","withCentrelink=").replace("withCentrelink=false","withCentrelink=").replace("withCentrelink=","withCentrelink="+b.toString()),a.formConfig.iframeUrl=i.trustAsResourceUrl(a.formConfig.rawUrl)},a.setUrl=function(b){a.formConfig.rawUrl=b,a.formConfig.iframeUrl=i.trustAsResourceUrl(b)},a.hints={amount:"Please enter amount you spend and choose how often you spend on this expense. For credit cards please enter credit card limit"},a.formConfig={deferred:null,formSaved:!1,htmlForm:null,serverErrors:[],formError:"Information above is not valid, please correct errors",newApp:!0,rawUrl:"",iframeUrl:null},a.modelBank={completed:!1,error:"",trace:[]}}])}();;
!function(){var a=angular.module("loanApp");a.factory("bankRepository",["$resource","bootstrappedData",function(a,b){return{saveBank:function(c,d){var e=a(b.apiLocation+"api/budget/bank/:clientKey",{clientKey:d}).save(c);return e}}}])}();;
!function(){var a=angular.module("loanApp");a.controller("SuccessController",["$scope","$location","$window","$q","$log","GOOGLE_EVENTS","$anchorScroll","commonSvc","formsSvc","bankRepository","seoSvc",function(a,b,c,d,e,f,g,h,i,j,k){i.registerScope("finish",a),a.title="SuccessController",g.yOffset=50,a.model={bsb:"",accountNo:"",url:""},a.process=function(c,d,e,f,h){a.formConfig.referenceNo=c,a.formConfig.firstName=d,a.formConfig.age=e,a.formConfig.isZdh=f,a.formConfig.redirectUrl=h,a.registerConversion(),a.applyStyleChanges(),b.hash("apply"),g()},a.formConfig={deferred:null,formSaved:!1,needBankInfo:!1,htmlForm:null,serverErrors:[],formError:"Information above is not valid, please correct errors",agreedBank:!1,referenceNo:"",age:null,firstName:"",isZdh:!1},a.registerConversion=function(){try{if(void 0!=dataLayer)if(a.showSuccess()){k.sendMouseflowFormSuccess("#generalInfoForm");var b=a.$root.loanType;-1!==b.indexOf("mini")&&dataLayer.push({event:"lbp_converted_mloan"}),-1!==b.indexOf("car")&&dataLayer.push({event:"lbp_converted_cloan"}),dataLayer.push({event:"lbp_converted"})}else dataLayer.push({event:"lbp_loanrejected"})}catch(c){e.error(c)}},a.errorsVisible=function(a,b){return h.errorsVisible(a,b)},a.holdingCointainerClass=function(a,b){return h.holdingCointainerClass(a,b)},a.getHint=function(b){return a.formConfig.isZdh&&(b="zdh"+b),h.getHint(b,a.hints)},a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=d.defer(),a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.model}):i.saveForm("bank",a.innerSave),a.formConfig.deferred.promise},a.innerSave=function(){i.saveFailed("bank","Bank info already saved")},a.close=function(){window.location.assign(a.formConfig.redirectUrl)},a.showSuccess=function(){return a.formConfig.age>19},a.showContinue=function(){return null!=a.formConfig.redirectUrl&&a.formConfig.redirectUrl.length>1},a.ok=function(){a.formConfig.agreedBank=!0,a.formDisabled=!1},a.cancel=function(){window.location.assign(a.formConfig.redirectUrl)},a.hints={phone:"1300 661 991",zdhphone:"1300 793 763",product:"loan",zdhproduct:"",company:"Safe Financial",zdhcompany:"Zero Deposit Holidays"},a.applyStyleChanges=function(){var b=a.showSuccess()?"app-success":"app-fail";$(".url-skin").addClass(b)}}])}();;
!function(){var a=angular.module("loanApp");a.controller("BudgetController",["$scope","formsSvc","commonSvc","lookupSvc","$q","$log","budgetRepository","GOOGLE_EVENTS","seoSvc",function(a,b,c,d,e,f,g,h,i){b.registerScope("budget",a),a.title="BudgetController",a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=e.defer(),a.htmlForm.$valid?(a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.modelBudget}):b.saveForm("budget",a.innerSave),a.formConfig.deferred.promise):(a.formConfig.deferred.reject({err:"Unable to save budget with invalid data"}),a.formConfig.deferred.promise)},a.innerSave=function(){a.refreshBudgetItems();var c="";if(null==a.$root.applicationKey||0==a.$root.applicationKey.length)c="Unable to save budget prior to application",f.info(c),a.formConfig.deferred.reject({err:c}),b.saveFailed("budget",c);else if(null==a.$root.principalKey||0==a.$root.principalKey.length)c="Unable to save budget, your personal information is not available. Please give us a call.",f.info(c),a.formConfig.deferred.reject({err:c}),b.saveFailed("budget",c);else{var d=g.saveBudget(a.modelBudget,a.$root.applicationKey,a.$root.principalKey);d.$promise.then(a.budgetSaved,a.saveFailed)}i.sendMouseflowFormAttempt("#budgetForm")},a.$on("BudgetController.saveBudget",a.save),a.budgetSaved=function(c){b.saveComplete("budget",c),a.$emit("Global.BudgetSaved",c),i.sendMouseflowFormSuccess("#budgetForm")},a.saveFailed=function(a){c.sendGoogleEvent(h.CAT_APP_ERROR,h.ACT_ERR_SERVER,"Budget failed"),b.saveFailed("budget",a),i.sendMouseflowFormFailure("#budgetForm")},a.initPage=function(b){a.htmlForm=b},a.holdingCointainerClass=function(a,b){return c.holdingCointainerClass(a,b)},a.errorsVisible=function(a,b){return c.errorsVisible(a,b)},a.getHint=function(b){return c.getHint(b,a.hints)},a.refreshBudgetItems=function(){a.modelBudget.budgetItemList=null,a.modelBudget.budgetItemList=[];for(var b=a.getMultiChoiceExpenses(),c=0;c<b.length;c++)b[c].selected&&a.pushBudgetItem(b[c].value,1,0);if(b=null,a.formConfig.accomodationAmount>0&&a.pushBudgetItem(a.formConfig.accomodationType,a.formConfig.accomodationAmount,a.formConfig.accomodationFrequency),a.formConfig.vehicleAmount>0&&a.pushBudgetItem(a.formConfig.vehicleType,a.formConfig.vehicleAmount,a.formConfig.vehicleFrequency),a.formConfig.loanAmount>0){var d=a.formConfig.loanQty;1===d?a.pushBudgetItem(a.formConfig.loanType,a.formConfig.loanAmount,a.formConfig.loanFrequency):a.pushBudgetItem(a.formConfig.loanType,a.formConfig.loanAmount,a.formConfig.loanFrequency,"Loans: "+d.toString())}a.formConfig.cardAmount>0&&a.pushBudgetItem(a.formConfig.cardType,a.formConfig.cardAmount,0)},a.pushBudgetItem=function(b,c,d,e){null==e&&(e="");var f=angular.copy(a.modelBudgetItem);f.itemType=b,f.amount=c,f.frequency=d,f.notes=e,a.modelBudget.budgetItemList.push(f)},a.expenseTypeList=d.getExpenseTypeList(),a.frequencyList=d.getBudgetFrequencyList(),a.formDisabled=!1,a.getMultiChoiceExpenses=function(){for(var b=[],c=0;c<a.expenseTypeList.length;c++)(271==a.expenseTypeList[c].value||273==a.expenseTypeList[c].value||238==a.expenseTypeList[c].value||246==a.expenseTypeList[c].value)&&b.push(a.expenseTypeList[c]);return b},a.multiChoiceExpenseList=a.getMultiChoiceExpenses(),a.getExpensesLabelText=function(){var a="Please enter your regular expenses below";return a},a.showAccommodationExpense=function(){var b=a.$root.accomodationType;return null==b||0==b.length||-1==b.toLowerCase().indexOf("own")},a.getAccommodationType=function(){var b=a.$root.accomodationType;return null==b||0==b.length?(a.formConfig.accomodationType=201,"accommodation"):(a.formConfig.accomodationType=-1!=b.indexOf("Board")?200:-1!=b.indexOf("Rent")?201:203,b)},a.hints={amount:"Please enter amount you spend and choose how often you spend on this expense. For credit cards please enter credit card limit",accomodation:"Please enter amount that you spend on your accommodation and select how often you need to pay",frequency:"Please select how frequently you spend amount you have entered",addAnother:"Click to add next expense. Please be accurate and specify all expenses that apply as it shortens time required for assessment process",livingExpenses:"Please select the regular expense items you have – multiple selections are allowed",loans:"Please enter total amount of repayments you are paying on personal loans",loansQty:"Please enter how many personal loans you currently have",creditcard:"Please enter the total combined limit of all Credit and Store cards that you have",vehicle:"Please enter the amount of your car repayment",vehicleFrequency:"Please select the frequency of your car loan repayment",261:"This includes Car, Home, Funeral, Vehicle Insurance"},a.formConfig={deferred:null,formSaved:!1,htmlForm:null,serverErrors:[],formError:"Information above is not valid, please correct errors",newApp:!0,expenseCategory:1,accomodationAmount:null,accomodationFrequency:null,accomodationType:null,vehicleAmount:null,vehicleFrequency:null,vehicleType:220,loanAmount:null,loanQty:null,loanFrequency:null,loanType:240,cardAmount:null,cardType:241},a.modelBudget={budgetItemList:[],confirmationNo:null,redirectUrl:null},a.modelBudgetItem={itemType:null,category:a.formConfig.expenseCategory,amount:null,frequency:null,notes:""},a.model={config:a.formConfig,budget:a.modelBudget,currentItem:a.modelBudgetItem},a.$watch("modelBudget",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelBudgetItem",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.getExpenseTypeDescr=function(b){for(var c=0;c<a.expenseTypeList.length;c++)if(a.expenseTypeList[c].value==b)return a.expenseTypeList[c].text;return b},a.getFrequencyDescr=function(b){for(var c=0;c<a.frequencyList.length;c++)if(a.frequencyList[c].value==b)return a.frequencyList[c].text;return b},a.isCurrentBudgetItemComplete=function(){return null==a.modelBudgetItem.itemType&&null==a.modelBudgetItem.amount&&null==a.modelBudgetItem.frequency?!1:!0},a.budgetItemValidatorsActive=function(){return 0==a.modelBudget.budgetItemList.length},a.$watch("modelBudget",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.addBudgetItem=function(){var b=angular.copy(a.modelBudgetItem);a.modelBudget.budgetItemList.push(b),a.modelBudgetItem.itemType=null,a.modelBudgetItem.amount=null,a.modelBudgetItem.frequency=null}}])}();;
!function(){var a=angular.module("loanApp");a.factory("budgetRepository",["$resource","bootstrappedData",function(a,b){return{saveBudget:function(c,d,e){var f=a(b.apiLocation+"api/budget/:clientKey/:personKey",{clientKey:d,personKey:e}).save(c);return f}}}])}();;
!function(){var a=angular.module("loanApp");a.controller("EmploymentController",["$scope","seoSvc","formsSvc","commonSvc","lookupSvc","$interval","$q","$log","$location","$anchorScroll","employmentRepository","GOOGLE_EVENTS",function(a,b,c,d,e,f,g,h,i,j,k,l){c.registerScope("employment",a),a.title="EmploymentController",a.$on("EmploymentController.saveEmployment",a.save),a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=g.defer(),a.htmlForm.$valid?(a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.modelEmployment}):c.saveForm("employment",a.innerSave,a.validate),a.formConfig.deferred.promise):(a.htmlForm.$setSubmitted(),a.formConfig.deferred.reject({err:"Unable to save employment info with invalid data"}),a.formConfig.deferred.promise)},a.validate=function(){return a.addCompletedEmployerToList(),a.validateIncome()},a.innerSave=function(){if(b.sendMouseflowFormAttempt("#employmentForm"),null==a.$root.principalKey||0===a.$root.principalKey.length)h.info("Unable to save employment prior to personal info"),a.formConfig.deferred.reject({err:"Unable to save employment prior to personal info"});else{var c=k.saveEmployment(a.modelEmployment,a.$root.applicationKey,a.$root.principalKey);c.$promise.then(a.employmentSaved,a.saveFailed)}},a.employmentSaved=function(e){c.saveComplete("employment",e),d.sendGoogleEvent(l.CAT_GOAL,l.ACT_EMPLOYMENT_DONE,l.LBL_COMPLETED_EMPLOYMENT),a.emitCenterlink(),b.sendMouseflowFormSuccess("#employmentForm")},a.saveFailed=function(a){c.saveFailed("employment",a),d.sendGoogleEvent(l.CAT_APP_ERROR,l.ACT_ERR_SERVER,"Employment saved failed"),b.sendMouseflowFormFailure("#employmentForm")},a.initPage=function(b){a.htmlForm=b},a.pastClient=function(b){a.formConfig.pastClient=b,b?(a.formConfig.hideRefernces=!0,a.modelEmployment.reference1.firstName=null==a.modelEmployment.reference1.firstName||0==a.modelEmployment.reference1.firstName.length?"Past":a.modelEmployment.reference1.firstName,a.modelEmployment.reference1.lastName=null==a.modelEmployment.reference1.lastName||0==a.modelEmployment.reference1.lastName.length?"Past":a.modelEmployment.reference1.lastName,a.modelEmployment.reference1.phone=null==a.modelEmployment.reference1.phone||0==a.modelEmployment.reference1.phone.length?"1234567890":a.modelEmployment.reference1.phone,a.modelEmployment.reference2.firstName=null==a.modelEmployment.reference2.firstName||0==a.modelEmployment.reference2.firstName.length?"Past":a.modelEmployment.reference2.firstName,a.modelEmployment.reference2.lastName=null==a.modelEmployment.reference2.lastName||0==a.modelEmployment.reference2.lastName.length?"Past":a.modelEmployment.reference2.lastName,a.modelEmployment.reference2.phone=null==a.modelEmployment.reference2.phone||0==a.modelEmployment.reference2.phone.length?"1234567890":a.modelEmployment.reference2.phone):a.hideReferenceSource()||(a.formConfig.hideRefernces=!1,a.modelEmployment.reference1.firstName="Past"==a.modelEmployment.reference1.firstName?"":a.modelEmployment.reference1.firstName,a.modelEmployment.reference1.lastName="Past"==a.modelEmployment.reference1.lastName?"":a.modelEmployment.reference1.lastName,a.modelEmployment.reference1.phone="1234567890"==a.modelEmployment.reference1.phone?"":a.modelEmployment.reference1.phone,a.modelEmployment.reference2.firstName="Past"==a.modelEmployment.reference2.firstName?"":a.modelEmployment.reference2.firstName,a.modelEmployment.reference2.lastName="Past"==a.modelEmployment.reference2.lastName?"":a.modelEmployment.reference2.lastName,a.modelEmployment.reference2.phone="1234567890"==a.modelEmployment.reference2.phone?"":a.modelEmployment.reference2.phone)},a.setSource=function(b){a.formConfig.source=b,a.hideReferenceSource()?(a.formConfig.hideRefernces=!0,a.modelEmployment.reference1.firstName=null==a.modelEmployment.reference1.firstName||0==a.modelEmployment.reference1.firstName.length?"Past":a.modelEmployment.reference1.firstName,a.modelEmployment.reference1.lastName=null==a.modelEmployment.reference1.lastName||0==a.modelEmployment.reference1.lastName.length?"Past":a.modelEmployment.reference1.lastName,a.modelEmployment.reference1.phone=null==a.modelEmployment.reference1.phone||0==a.modelEmployment.reference1.phone.length?"1234567890":a.modelEmployment.reference1.phone,a.modelEmployment.reference2.firstName=null==a.modelEmployment.reference2.firstName||0==a.modelEmployment.reference2.firstName.length?"Past":a.modelEmployment.reference2.firstName,a.modelEmployment.reference2.lastName=null==a.modelEmployment.reference2.lastName||0==a.modelEmployment.reference2.lastName.length?"Past":a.modelEmployment.reference2.lastName,a.modelEmployment.reference2.phone=null==a.modelEmployment.reference2.phone||0==a.modelEmployment.reference2.phone.length?"1234567890":a.modelEmployment.reference2.phone):a.formConfig.pastClient||(a.formConfig.hideRefernces=!1,a.modelEmployment.reference1.firstName="Past"==a.modelEmployment.reference1.firstName?"":a.modelEmployment.reference1.firstName,a.modelEmployment.reference1.lastName="Past"==a.modelEmployment.reference1.lastName?"":a.modelEmployment.reference1.lastName,a.modelEmployment.reference1.phone="1234567890"==a.modelEmployment.reference1.phone?"":a.modelEmployment.reference1.phone,a.modelEmployment.reference2.firstName="Past"==a.modelEmployment.reference2.firstName?"":a.modelEmployment.reference2.firstName,a.modelEmployment.reference2.lastName="Past"==a.modelEmployment.reference2.lastName?"":a.modelEmployment.reference2.lastName,a.modelEmployment.reference2.phone="1234567890"==a.modelEmployment.reference2.phone?"":a.modelEmployment.reference2.phone)},a.hideReferenceSource=function(){for(var b=0;b<a.formConfig.hideReferncesSources.length;b++)if(a.formConfig.source==a.formConfig.hideReferncesSources[b])return!0;return!1},a.emitCenterlink=function(){for(var b=0;b<a.modelEmployment.employers.length;b++)if(a.modelEmployment.employers[b].employmentType===a.formConfig.benefitType)return void a.$emit("Global.HasCenterlink",!0);a.$emit("Global.HasCenterlink",!1)},a.holdingCointainerClass=function(a,b){return d.holdingCointainerClass(a,b)},a.getIncomeLabelText=function(){var b="Your Income";return null!=a.$root.borrowerName&&a.$root.borrowerName.length>0&&(b=a.$root.borrowerName+", we also need you to list your Income"),b},a.getEmploymentTypeTooltip=function(b){return b==a.formConfig.benefitType?a.getHint("benefitEmployment"):""},a.getReferencesLabelText=function(){var b="References";return null!=a.$root.borrowerName&&a.$root.borrowerName.length>0&&(b="We’re almost there "+a.$root.borrowerName+", please provide a friend and family member as a character reference (we will speak with you before we call them)."),b},a.errorsVisible=function(b,c){var e=d.errorsVisible(b,c);return-1==c.$name.indexOf("Reference")&&(e=e||a.formConfig.addingEmployer),e},a.isCenterLinkOnly=function(){return 1===a.modelEmployment.employers.length&&a.modelEmployment.employers[0].employmentType===a.formConfig.benefitType},a.validateNumber=function(b){var c="";if(null!=b.$viewValue&&b.$viewValue.length>0&&(c=b.$viewValue.replace(/ /g,"")),!b.$dirty)return!0;var d=!0;return a.modelEmployment.reference1.phoneNo===a.modelEmployment.reference2.phoneNo&&(b.$setValidity("sameAsAnotherRef",!1),d=!1),d&&b.$setValidity("sameAsAnotherRef",!0),c.trim()===a.$root.borrowerPhone.trim()?(b.$setValidity("sameAsYourPhone",!1),!1):(b.$setValidity("sameAsYourPhone",!0),!0)},a.formDisabled=!1,a.stateList=e.getCountryStates(!0),a.timeAtEmploymentList=e.getTimeAtPlaceList(),a.employmentTypeList=e.getEmploymentTypeList(),a.frequencyList=e.getBudgetFrequencyList(),a.hints={references:"Please list one friend and one family member who is not living with you as a reference and point of contact",addIncome:'If you receive a second income or regular payment please "add another income"',addZdhBorrowerIncome:'If you receive a second income or regular payment please "add another income"',addBorrowerIncome:'If you receive a second income or regular payment please "add another income"',addCoBorrowerIncome:"Please enter income for the co-borrower",addCoZdhBorrowerIncome:"Please enter income for the co-applicant",addBorrowerIncomeBtn:"Add another income",addZdhBorrowerIncomeBtn:"Add another income",addCoZdhBorrowerIncomeBtn:"Add co-applicant income",addCoBorrowerIncomeBtn:"Add co-borrower income",frequency:"Please select how often you receive this amount",amount:'Please enter the "take home" amount from this source of income',incomeSource:"Please enter your income. If receiving Workcover, Super, DVA, Docs please list as Other Income",benefitEmployment:"Enter your full amount of benefit before deductions",timeAtEmployer:"Please select the length of time you have received this income for",businessName:"Please enter the name of your Employer, Benefit provider or Business",minimalIncomeError:"It appears your Total Income is less than $500 per week – Please check you have entered your Income correctly"},a.formConfig={formSaved:!1,hideRefernces:!1,pastClient:!1,addingEmployer:!1,htmlForm:null,deferred:null,serverErrors:[],minIncomeAmount:500,formError:"Information above is not valid, please correct errors",minIncomeWarning:!1,benefitType:"6",childType:"7",clientId:1,currentSource:0,newApp:!0,hideReferncesSources:[181,235,491,897,1120,1122]},a.modelEmployment={employmentType:0,employerName:"",employerPhone:"",timeAtEmployment:null,employers:[],reference1:{firstName:"",lastName:"",phoneNo:null,callingTime:null},reference2:null},a.modelEmployer={employmentType:null,employerName:"",employerPhone:"",timeAtEmployment:null,incomeAmount:null,frequency:null,isDeleted:!1,clientId:null,clientKey:null},a.modelEmployment.reference2=angular.copy(a.modelEmployment.reference1),a.model={config:a.formConfig,employment:a.modelEmployment,currentEmployer:a.modelEmployer},a.fillTest=function(){var b=Math.floor(1e3*Math.random(),2);a.modelEmployment.employmentType=a.employmentTypeList[0].value,a.modelEmployment.timeAtEmployment=a.timeAtEmploymentList[0].value,a.modelEmployment.employerName="Test Emp "+b.toString(),a.modelEmployment.reference1.firstName="Ref 1_"+b.toString(),a.modelEmployment.reference1.lastName="Person",a.modelEmployment.reference1.phone="0414566867",a.modelEmployment.reference2.firstName="Ref 2_"+b.toString(),a.modelEmployment.reference2.lastName="Person",a.modelEmployment.reference2.phone="0414466867",a.modelEmployer.employmentType=a.employmentTypeList[0].value,a.modelEmployer.employerName="Test Emp "+b.toString(),a.modelEmployer.timeAtEmployment=a.timeAtEmploymentList[0].value,a.modelEmployer.incomeAmount=5e3,a.modelEmployer.frequency=a.frequencyList[0].value},a.getEmploymentTypeDescr=function(b){for(var c=0;c<a.employmentTypeList.length;c++)if(a.employmentTypeList[c].value==b)return a.employmentTypeList[c].text;return b},a.getTotalIncome=function(){for(var b=0,c=0;c<a.modelEmployment.employers.length;c++){var d=parseFloat(a.modelEmployment.employers[c].incomeAmount);"1"==a.modelEmployment.employers[c].frequency&&(d/=2),"2"==a.modelEmployment.employers[c].frequency&&(d=12*d/52),"3"==a.modelEmployment.employers[c].frequency&&(d=4*d/52),"4"==a.modelEmployment.employers[c].frequency&&(d/=52),b+=d}return b},a.showIncomeError=function(){return a.formConfig.minIncomeWarning},a.validateIncome=function(){var b=a.getTotalIncome();return b<a.formConfig.minIncomeAmount?(h.info("Total income per week is below threshold $"+b+" < $"+a.formConfig.minIncomeAmount),a.formConfig.minIncomeWarning=!0,!1):(a.formConfig.minIncomeWarning=!1,!0)},a.getFrequencyDescr=function(b){for(var c=0;c<a.frequencyList.length;c++)if(a.frequencyList[c].value==b)return a.frequencyList[c].text;return b},a.hasCoBorrower=function(){return a.$root.hasCoBorrower},a.showCoBorrowerHint=function(){return a.hasCoBorrower()},a.getHint=function(b){return-1!=b.indexOf("Borrower")&&a.showCoBorrowerHint()&&(b=b.replace("Borrower","CoBorrower")),a.$root.isZdh&&(b=b.replace("Borrower","ZdhBorrower")),d.getHint(b,a.hints)},a.getEmployerName=function(b,c){return null!=b&&b!=a.formConfig.benefitType?c:"Centrelink"},a.deleteEmployment=function(b){if(null!=b)for(var c=0;c<a.modelEmployment.employers.length;c++)a.modelEmployment.employers[c].clientId==b&&a.modelEmployment.employers.splice(c,1)},a.addCompletedEmployerToList=function(){a.isCurrentEmployerComplete()&&a.addEmployer(!1)},a.needEmployerName=function(){return null!=a.modelEmployer.employmentType&&a.modelEmployer.employmentType!=a.formConfig.benefitType&&a.modelEmployer.employmentType!=a.formConfig.childType},a.isCurrentEmployerComplete=function(){return(null!=a.modelEmployer.employerName&&a.modelEmployer.employerName.length>0||!a.needEmployerName())&&null!=a.modelEmployer.employmentType&&null!=a.modelEmployer.timeAtEmployment&&null!=a.modelEmployer.incomeAmount&&null!=a.modelEmployer.frequency?!0:!1},a.employerValidatorsActive=function(b){var c=0==a.modelEmployment.employers.length||null!=a.modelEmployer.incomeAmount;return-1==b.$name.indexOf("Reference")&&(c=c||a.formConfig.addingEmployer),c},a.addEmployer=function(b){if(a.formConfig.addingEmployer=!0,a.isCurrentEmployerComplete()){var c=angular.copy(a.modelEmployer);null!=c.employmentType&&c.employmentType==a.formConfig.benefitType&&(c.employerName="Centrelink"),null!=c.employmentType&&c.employmentType==a.formConfig.childType&&(c.employerName="Private or through Agency"),c.clientId=a.formConfig.clientId,a.modelEmployment.employers.push(c),a.modelEmployer.employerName="",a.modelEmployer.employerPhone="",a.modelEmployer.employmentType=null,a.modelEmployer.timeAtEmployment=null,a.modelEmployer.incomeAmount=null,a.modelEmployer.frequency=null,a.modelEmployer.isDeleted=!1,a.modelEmployer.clientId=null,a.modelEmployer.clientKey=null,a.formConfig.addingEmployer=!1,a.formConfig.clientId++,b&&i.hash("incomeList")}},a.$watch("modelEmployment.reference2.lastName",function(a,b){(null!=a&&a.length>0||null!=b&&b.length>0)&&c.validateForm("employment")}),a.$watch("modelEmployment",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelEmployer.incomeAmount",function(b){null!=b&&(a.formConfig.minIncomeWarning=!1)},!0),a.$watch("modelEmployer.frequency",function(b){null!=b&&(a.formConfig.minIncomeWarning=!1)},!0)}])}();;
!function(){var a=angular.module("loanApp");a.factory("employmentRepository",["$resource","bootstrappedData",function(a,b){return{saveEmployment:function(c,d,e){var f=a(b.apiLocation+"api/employment/:clientKey/:personClientKey",{clientKey:d,personClientKey:e}).save(c);return f}}}])}();;
!function(){var a=angular.module("enqApp");a.controller("EnquiryController",["$scope","lookupSvc","$q","$log","$timeout","$http","$anchorScroll","$location","bootstrappedData","enquiryRepository","seoSvc","commonSvc","formsSvc","GOOGLE_EVENTS",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){m.registerScope("enquiry",a),a.title="EnquiryController",a.applicationSaved=!1,a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=c.defer(),a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.modelEnquiry}):m.saveForm("enquiry",a.innerSave),a.formConfig.deferred.promise},a.innerSave=function(){null!=a.modelEnquiry.assetCashAmount&&a.modelEnquiry.assetCashAmount>0&&(a.modelEnquiry.notes=null==a.modelEnquiry.notes?"":a.modelEnquiry.notes+" Total cash deposits: $"+a.modelEnquiry.assetCashAmount+".00 "),null!=a.modelEnquiry.homeLoanPurpose&&a.modelEnquiry.homeLoanPurpose.length>0&&(a.modelEnquiry.notes=null==a.modelEnquiry.notes?"":a.modelEnquiry.notes+" Purpose of home loan: "+a.modelEnquiry.homeLoanPurpose),k.sendMouseflowFormAttempt("#enquiryForm");var b=j.saveEnquiry(a.modelEnquiry);b.$promise.then(a.saveComplete,a.saveFailed)},a.saveComplete=function(b){m.saveComplete("enquiry",b),a.$emit("Global.EnquirySaved"),b.enquiryId>0&&(a.showCompleted(b.enquiryId,a.modelEnquiry.firstName,!0,b.redirectUrl),k.sendMouseflowFormSuccess("#enquiryForm"))},a.saveFailed=function(b){a.formDisabled=!1,m.saveFailed("enquiry",b),l.sendGoogleEvent(n.CAT_APP_ERROR_ENQ,n.ACT_ERR_SERVER,"Enquiry saved failed"),k.sendMouseflowFormFailure("#enquiryForm")},a.showContinue=function(){return null!=a.formConfig.redirectUrl&&a.formConfig.redirectUrl.length>1},a.showReferringSource=function(){return!(a.formConfig.hideSourceSelection||void 0!=a.modelEnquiry.referringSource&&null!=a.modelEnquiry.referringSource&&(a.modelEnquiry.referringSource!==a.formConfig.promotionSource||a.modelEnquiry.referringSource!==a.formConfig.socialMediaSource)&&a.modelEnquiry.referringSourceDetail.length>0&&a.modelEnquiry.referringSourceDetail!==a.formConfig.webReferrer)},a.showCompleted=function(b,c,d,e){d&&(a.formConfig.redirectUrl=e,a.formConfig.confirmationNo=b,a.formConfig.isSuccessful=d);var f=a.formConfig.enquiryType;-1!=f.indexOf("debt")&&(l.sendGoogleEvent(n.CAT_GOAL,n.ACT_ENQ_DEBT_COMPLETED,n.LBL_COMPLETED_ENQ),dataLayer.push({event:"lbp_converted_enqdebt"})),-1!=f.indexOf("home")&&(l.sendGoogleEvent(n.CAT_GOAL,n.ACT_ENQ_HOM_COMPLETED,n.LBL_COMPLETED_ENQ),dataLayer.push({event:"lbp_converted_enqhome"})),-1!=f.indexOf("bus")&&(l.sendGoogleEvent(n.CAT_GOAL,n.ACT_ENQ_BUS_COMPLETED,n.LBL_COMPLETED_ENQ),dataLayer.push({event:"lbp_converted_enqbus"})),dataLayer.push({event:"lbp_converted_enq"}),a.applicationSaved=!0,h.hash("apply"),g()},a.setExternalData=function(b,c){a.formConfig.enquiryType=b,a.modelEnquiry.enquiryType=c,a.isAndroid=!1,a.isAppResult=!1},a.updateAmount=function(b){e(function(){a.modelEnquiry.amount=b})},a.setAnalyticsId=function(b){"undefined"==typeof b||0==b.length||-1!=b.indexOf("ERR:")?l.logEvent("ui.err.ga-notfound",{message:"Failed to get GA UID "+JSON.stringify(a.modelEnquiry),error:b}):a.modelEnquiry.googleAnalyticsId=b},a.initPage=function(b){a.htmlForm=b,a.$root.appHistory=[],a.formConfig.webReferrer=k.getWebReferrer(),a.formConfig.enquiryType=i.enquiryType,a.modelEnquiry.enquiryType=i.enquiryTypeVal,a.isAndroid=i.isAndroid,a.isAppResult=i.isAppResult,i.isAppResult&&(a.modelEnquiry.email=i.email,a.modelEnquiry.contactNumber=i.phone,a.modelEnquiry.firstName=i.firstName,a.modelEnquiry.lastName=i.lastName,a.modelEnquiry.referringSource=i.referringSource,a.modelEnquiry.notes=i.notes,a.modelEnquiry.contactTime="",a.modelEnquiry.dobString="1/1/1980",a.modelEnquiry.state=i.state),i.isShortForm&&(a.modelEnquiry.email=i.email,a.modelEnquiry.firstName=i.firstName,a.modelEnquiry.lastName=i.lastName,a.modelEnquiry.referringSource=i.referringSource,a.modelEnquiry.contactTime="",a.modelEnquiry.assetsNone=!0),11===i.enquiryTypeVal&&(a.modelEnquiry.dobString="1/1/1980",a.modelEnquiry.amount=0,a.modelEnquiry.referringSource=i.referringSource),a.modelEnquiry.searchPhrase=k.getSearchTerm(),a.modelEnquiry.googleClickID=k.getGoogleClickId(),k.getGoogleAnalyticsId(a.setAnalyticsId),a.modelEnquiry.referringSourceDetail=k.getWebReferrer(),a.parseQueryString();var c=h.search().src;if((void 0==c||0===c.length)&&(c=h.search().utm_source),void 0!=c&&c.length>0)switch(c){case"facebook":case"fb":a.modelEnquiry.referringSourceDetail="Facebook Ad",a.modelEnquiry.referringSource=a.formConfig.socialMediaSource,a.formConfig.hideSourceSelection=!0,void 0!=dataLayer&&dataLayer.push({event:"fb_origin"});break;case"ndc":a.modelEnquiry.referringSourceDetail="Newsletter campaign",a.modelEnquiry.referringSource=a.formConfig.promotionSource,a.formConfig.hideSourceSelection=!0;break;default:var d=parseInt(c);d!==0/0&&d>0&&(a.modelEnquiry.referringSource=d,a.formConfig.hideSourceSelection=!0)}l.sendGoogleEvent(n.CAT_UI_PROGRESS_ENQ,n.ACT_APP_START,n.LBL_ENQ_LOADED)},a.parseQueryString=function(){var b=h.search(),c=!1,d={};Object.keys(b).forEach(function(a){d[a.toLowerCase().replace(/-/g,"")]=b[a]});var e=d.transaction_id;void 0!==e&&e.length>0&&(a.modelEnquiry.eqfTransactionId=e,a.modelEnquiry.referringSourceDetail=e);var f=d.firstname;void 0!==f&&f.length>0&&(a.modelEnquiry.firstName=f,c=!0);var g=d.lastname;void 0!==g&&g.length>0&&(a.modelEnquiry.lastName=g,c=!0);var i=d.email;void 0!==i&&i.length>0&&(a.modelEnquiry.email=i,c=!0);var j=d.contactnumber;void 0!==j&&j.length>0&&(a.modelEnquiry.contactNumber=j,c=!0);var k=d.amount;void 0!==k&&k.length>0&&(a.modelEnquiry.amount=parseInt(k),c=!0);var l=d.referringsource;if(void 0!==l&&l.length>0){var m=parseInt(l);m!==0/0&&m>0&&(a.modelEnquiry.referringSourceDetail="",a.modelEnquiry.referringSource=m,a.formConfig.hideSourceSelection=!0,c=!0)}var n=d.referringsourcedetail;void 0!==n&&n.length>0&&(a.modelEnquiry.referringSourceDetail=n,c=!0);var o=d.dob;if(void 0!==o&&o.length>0){var p=parseInt(o.substring(0,4)),q=parseInt(o.substring(5,7)),r=parseInt(o.substring(9,11));a.modelEnquiry.dob=new Date(p,q-1,r),c=!0}c&&(a.htmlForm.$submitted=!0)},a.validateDate=function(b){var c=b.$viewValue;if(!b.$dirty)return!0;if(!a.isOzDateFormat(c))return b.$setValidity("pattern",!1),l.sendGoogleEvent(n.CAT_UI_ERROR_ENQ,n.ACT_ERR_DOB,n.LBL_ERR_DATE_FORMAT),l.logEvent("ui.error.enq",{message:"Invalid date format "+c}),!1;if(b.$setValidity("pattern",!0),b.$setValidity("invalidDate",!0),-1!=b.$name.toLowerCase().indexOf("dob")){var d=a.getOzDate(c);if(d<a.modelEnquiry.minDob||d>a.modelEnquiry.maxDob)return b.$setValidity("invalidDate",!1),l.logEvent("ui.error.enq",{message:"Invalid age "+c}),l.sendGoogleEvent(n.CAT_UI_ERROR_ENQ,n.ACT_ERR_DOB,n.LBL_ERR_DOB),!1}return!0},a.holdingCointainerClass=function(a,b){return l.holdingCointainerClass(a,b)},a.errorsVisible=function(a,b){return l.errorsVisible(a,b)},a.validateDob=function(b,c){b<a.modelEnquiry.minDob||b>a.modelEnquiry.maxDob?(c.$setValidity("invalidDate",!1),l.logEvent("ui.error.dob",{message:"Invalid age "+b})):c.$setValidity("invalidDate",!0)},a.openDob=function(b){b.preventDefault(),b.stopPropagation(),a.modelEnquiry.dobOpened=!0},a.getHint=function(b){return"ourPhone"==b&&"Auto"==a.modelEnquiry.firstName&&(b+="Auto"),"ourPhone"!==b&&"company"!==b||!a.isDebt()||(b+="Debt"),l.getHint(b,a.hints)},a.isDebt=function(){return-1!=a.formConfig.enquiryType.indexOf("debt")},a.isHome=function(){return-1!=a.formConfig.enquiryType.indexOf("home")},b.getTitles().then(function(b){a.titles=b},function(a){d.error("Failed to load titles from server:\n"+a)}),a.callingTimes=b.getCallTimes(),a.referringSources=b.getReferringSources(),a.hints={amountdebtLbl:"Debt Amount",amounthomeloanLbl:"Loan Amount",amountbusinessloanLbl:"Loan Amount",amountdebtHint:"Please enter your total amount of Debt",amounthomeloanHint:"How much do you want to borrow",amountbusinessloanHint:"Home much do you need?",amountdebt:"Please enter your total amount of Debt",amounthomeloan:"Home much is the home?",amountbusinessloan:"Home much do you need?",assetCashdebtLbl:"Cash in Bank",assetCashhomeloanLbl:"Amount of cash deposit",assetCashbusinessloanLbl:"Cash in Bank",assetCashdebtTip:"Please enter total cash in bank you have",assetCashhomeloanTip:"Please enter total cash deposit you have",assetCashbusinessloanTip:"Please enter total cash in bank you have",callTime:"Select which time suits you best for us to call",phone:"Enter your best contact number starting with 04 for mobile or 02,03,07,08 for Landline",phoneRefferee:"Enter your friend's best contact number starting with 04 for mobile or 02,03,07,08 for Landline",emailBorrower:"Please enter your email address. This will be used for confirmation emails, Enquiry related materials and marketing",emailRefferee:"Please enter your friend's email address. This will be used for confirmation emails, Enquiry related materials and marketing",source:"Please select how you found Safe Financial",assets:"Please select your current assets",assetOtherPh:"Asset details",assetOtherTip:"Please provide details of the assets you have",assetCashPh:"Total cash",bankrupt:"We need to know if you have been a bankrupt in the past 10 years",homeloanPurpose:"Please select what you intend to use loan funds for",assetNone:"",ourPhone:"1300 661 991",ourPhoneDebt:"1300 661 991",ourPhoneAuto:"1300 661 901",product:"Enquiry",company:"Safe Financial",companyDebt:"Safe Debt Management"},a.formDisabled=!1,a.homeLoanPurposes=[{value:"Refinance",text:"Re-finance",selected:!1},{value:"FirstHomeBuyer",text:"First Home Buyer",selected:!1},{value:"Purchase",text:"Purchase",selected:!1},{value:"Investment",text:"Investment",selected:!1},{value:"SMSF",text:"SMSF",selected:!1}],a.assetsList=[{value:"assetNone",text:"None",selected:!1},{value:"assetProperty",text:"Property",selected:!1},{value:"assetCar",text:"Car",selected:!1},{value:"assetCash",text:"Cash",selected:!1},{value:"assetOther",text:"Other",selected:!1}],a.stateList=[{value:"ACT",text:"ACT"},{value:"NSW",text:"NSW"},{value:"NT",text:"NT"},{value:"QLD",text:"QLD"},{value:"VIC",text:"VIC"},{value:"SA",text:"SA"},{value:"TAS",text:"TAS"},{value:"WA",text:"WA"}],a.formConfig={debtThresholdAmount:8e3,hideSourceSelection:!1,socialMediaSource:"890",promotionSource:"1",webReferrer:"",deferredSave:null,dateFormat:"dd/MM/yyyy",formSaved:!1,emailPattern:/^[_A-z0-9-]+(\.[-_A-z0-9]+)*@[A-z0-9-]+(\.[A-z0-9-]+)*(\.[A-z]{2,4})$/,htmlForm:null,serverErrors:[],formError:"Information above is not valid, please correct errors",isBeingSaved:!1,enquiryType:null,newApp:!0,assetSelected:null,wasBankrupt:null,redirectUrl:"/",confirmationNo:null,age:null,isSuccessful:!1},a.modelEnquiry={eqfTransactionId:"",amount:null,referringSource:null,referringSourceDetail:"",searchPhrase:"",googleClickID:"",googleAnalyticsId:"",clientKey:"",enquiryType:null,firstName:"",lastName:"",coFirstName:"",coLastName:"",notes:"",contactTime:"",contactNumber:"",coContactNumber:"",contactNumberType:1,email:"",coEmail:"",dob:null,dobString:"",dobInitial:new Date((new Date).getFullYear()-20,(new Date).getMonth(),(new Date).getDay()),minDob:new Date((new Date).getFullYear()-90,(new Date).getMonth(),(new Date).getDay()),maxDob:new Date((new Date).getFullYear()-18,(new Date).getMonth(),(new Date).getDay()),dobOpened:!1,dobDateOptions:{startingDay:1,initDate:new Date((new Date).getFullYear()-20,(new Date).getMonth(),(new Date).getDay()),showWeeks:!1},assetDetails:null,assetProperty:!1,assetCar:!1,assetCash:!1,assetCashAmount:null,assetOther:!1,assetNone:!1,state:null,homeLoanPurpose:null},a.getOzDate=function(a){try{if(a instanceof Date)return a;var b=a.split("/");if(3!=b.length)return null;var c=new Date(parseInt(b[2]),parseInt(b[1])-1,parseInt(b[0]));return c}catch(d){return null}},a.isOzDateFormat=function(a){return"string"==typeof a?null!=a.match(/^(([0-2]?\d{1})|([3][0,1]{1}))\/[0,1]?\d{1}\/(([1]{1}[9]{1}[2-9]{1}\d{1})|([2-9]{1}\d{3}))$/):!0},a.tryParseDate=function(b){if("string"==typeof b){var c=null;if(a.isOzDateFormat(b))return c=new Date(parseInt(b.substring(6,10)),parseInt(b.substring(3,5),parseInt(b.substring(0,2))));b=b.replace(" ","");var d="";if(8==b.length&&(d=b.substring(0,2)+"/"+b.substring(2,4)+"/"+b.substring(4,8),a.isOzDateFormat(d)))return c=new Date(parseInt(b.substring(4,8)),parseInt(b.substring(2,4),parseInt(b.substring(0,2))));if(6==b.length&&(d="0"+b.substring(0,1)+"/0"+b.substring(1,2)+"/"+b.substring(2,6),a.isOzDateFormat(d)))return c=new Date(parseInt(d.substring(6,10)),parseInt(d.substring(3,5),parseInt(d.substring(0,2))))}return null},a.$watch("modelEnquiry.contactNumber",function(b){a.modelEnquiry.contactNumberType=b&&b.length>1&&0==b.indexOf("04")?1:2}),a.$watch("modelEnquiry",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelEnquiry.dob",function(b){null!=b&&(a.validateDob(b,a.htmlForm.DOB),b instanceof Date&&(a.modelEnquiry.dobString=b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()))}),a.bankruptClicked=function(a,b){a.$setTouched(),a.$setDirty(),a.$setValidity("bankrupt",!b)},a.redirectToMiniLoan=function(){l.logEvent("miniloan-redirect.ui.msg.enq",{message:"Redirected to mini-loan from "+a.modelEnquiry.enquiryType,error:a.modelEnquiry.enquiryType})},a.checkAmount=function(b){a.isHome()&&parseInt(b.$viewValue)<5e4?(l.logEvent("home-amount.ui.error.enq",{message:"Invalid amount entered "+b.$viewValue,error:b.$viewValue}),b.$setValidity("smallamounthome",!1)):b.$setValidity("smallamounthome",!0),a.isDebt()&&parseInt(b.$viewValue)<8e3?(l.logEvent("debt-amount.ui.error.enq",{message:"Invalid amount entered "+b.$viewValue,error:b.$viewValue}),b.$setValidity("smallamount",!1)):b.$setValidity("smallamount",!0)},a.timeout=function(a){e(a)},a.assetClicked=function(b){a.modelEnquiry[b.value]=b.selected;var c=b.selected;if("assetNone"==b.value&&b.selected){a.modelEnquiry.assetProperty=!1,a.modelEnquiry.assetCar=!1,a.modelEnquiry.assetCash=!1,a.modelEnquiry.assetOther=!1,a.modelEnquiry.assetDetails=null;for(var d=0;d<a.assetsList.length;d++)a.assetsList[d].value!=b.value&&(a.assetsList[d].selected=!1),!c&&a.assetsList[d].selected&&(c=!0)}else{a.modelEnquiry.assetNone=!1;for(var d=0;d<a.assetsList.length;d++)"assetNone"==a.assetsList[d].value&&(a.assetsList[d].selected=!1),!c&&a.assetsList[d].selected&&(c=!0)}a.formConfig.assetSelected=c?!0:null}}])}();;
!function(){var a=angular.module("enqApp");a.factory("enquiryRepository",["$resource","bootstrappedData",function(a,b){return{saveEnquiry:function(c){var d=a(b.apiLocation+"api/enquiry").save(c);return d}}}])}();;
!function(){var a=angular.module("enqApp");a.controller("SuccessController",["$scope","$uibModalInstance","$location","$window","$q","$log","GOOGLE_EVENTS","commonSvc","formsSvc","referenceNo","firstName","isSuccessful","redirectUrl",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.formConfig={deferred:null,formSaved:!1,htmlForm:null,serverErrors:[],referenceNo:j,isSuccessful:l,firstName:k},a.holdingCointainerClass=function(a,b){return h.holdingCointainerClass(a,b)},a.showSuccess=function(){return a.formConfig.isSuccessful},a.getHint=function(b){return"phone"==b&&"Auto"==a.formConfig.firstName&&(b+="Auto"),h.getHint(b,a.hints)},a.close=function(){b.close(a.referenceNo),window.location.assign(l?m:"/")},a.ok=function(){a.formConfig.agreedBank=!0},a.cancel=function(){b.dismiss("cancel"),window.location.assign(l?m:"/")},a.hints={phone:"1300 661 991",phoneAuto:"1300 661 901",product:"Enquiry",company:"Safe Financial"}}])}();;
!function(){var a=angular.module("loanApp");a.controller("GovtWarningController",["$scope","$uibModalInstance","loanType","commonSvc","GOOGLE_EVENTS",function(a,b,c,d,e){a.loanType=c,d.sendGoogleEvent(e.CAT_GOAL,e.ACT_WARN_SHOWN,e.LBL_SAVED_GENERAL),a.ok=function(){b.close(a.loanType)},a.cancel=function(){b.dismiss("cancel")}}])}(),function(){var a=angular.module("loanApp");a.controller("GeneralController",["$scope","lookupSvc","$q","$log","$timeout","$anchorScroll","$location","bootstrappedData","$uibModal","generalRepository","seoSvc","commonSvc","formsSvc","seoSvc","GOOGLE_EVENTS",function(a,b,c,d,e,f,g,h,i,j,k,l,m,k,n){m.registerScope("general",a),a.title="GeneralController",a.save=function(){return a.formConfig.deferred=null,a.formConfig.deferred=c.defer(),a.htmlForm.$valid?(a.formConfig.formSaved?a.formConfig.deferred.resolve({data:a.modelGeneral,person:a.modelPerson,coPerson:a.modelCoPerson}):m.saveForm("general",a.innerSave),a.formConfig.deferred.promise):(a.htmlForm.$setSubmitted(),a.formConfig.deferred.reject({err:"Unable to save general info with invalid data"}),a.formConfig.deferred.promise)},a.$on("GeneralController.saveGeneralInfo",a.save),a.debug1=function(){return m.getCombinedModel()},a.innerSave=function(){a.modelGeneral.clientKey=a.$root.applicationKey,a.modelGeneral.loanPurpose=a.formConfig.isZdh?a.modelGeneral.zdhDestination+" from "+a.modelGeneral.zdhCity+", for "+a.modelGeneral.zdhDays+" days, on "+a.modelGeneral.zdhDeparture.getDay()+"/"+a.modelGeneral.zdhDeparture.getMonth()+"/"+a.modelGeneral.zdhDeparture.getFullYear()+", "+a.modelGeneral.zdhPaxNo+" people, kids: "+a.modelGeneral.zdhAges:null!=a.modelGeneral.loanPurposeValue&&a.modelGeneral.loanPurposeValue==a.formConfig.loanPurposeOtherVal?a.modelGeneral.loanPurposeOther:l.getLookupValue(a.loanPurposes,a.modelGeneral.loanPurposeValue),a.formConfig.borrowerSaved=!1,a.formConfig.coBorrowerSaved=!a.modelGeneral.hasCoBorrower,k.sendMouseflowFormAttempt("#generalInfoForm");var b=j.saveGeneral(a.modelGeneral);b.$promise.then(a.generalInfoSaved,a.saveFailed)},a.generalInfoSaved=function(b){d.debug("General info is saved successfully "+b.clientKey),b.clientKey&&b.clientKey.length>0&&(a.$emit("Global.ApplicationClientKeySet",b.clientKey),l.sendGoogleEvent(n.CAT_GOAL,n.ACT_GENERAL_DONE,n.LBL_SAVED_GENERAL)),a.$emit("Global.ReferringSource",b.referringSource);var c=j.savePerson(a.modelPerson,b.clientKey);c.$promise.then(a.personSaved,a.saveFailed)},a.personSaved=function(b){if(d.debug("Personal info is saved successfully "+b.clientKey),a.formConfig.borrowerSaved=!0,a.$emit("Global.PrincipalKeySet",b.clientKey),a.modelPerson.clientKey=b.clientKey,null!=b.bankUrl&&b.bankUrl.length>0&&a.$emit("Global.BankUrlSet",b.bankUrl),a.modelGeneral.hasCoBorrower){var c=j.savePerson(a.modelCoPerson,a.$root.applicationKey);c.$promise.then(a.coPersonSaved,a.saveFailed)}else a.formDisabled=!1,a.formConfig.isBeingSaved=!1,a.formConfig.formSaved=!0,d.debug(b),a.formConfig.deferred.resolve({data:b});l.sendGoogleEvent(n.CAT_GOAL,n.ACT_PERSONAL_DONE,n.LBL_COMPLETED_PERSONAL),k.sendMouseflowFormSuccess("#generalInfoForm")},a.coPersonSaved=function(b){d.debug("Co-personal info is saved successfully "+b.clientKey),b.isCoBorrower&&(a.formConfig.coBorrowerSaved=!0,a.$emit("Global.CoBorrowerKeySet",b.clientKey),a.modelCoPerson.clientKey=b.clientKey),a.formConfig.isBeingSaved=!1,a.formConfig.formSaved=!0,a.formDisabled=!1,d.debug(b),a.formConfig.deferred.resolve({data:b})},a.saveFailed=function(b){a.formDisabled=!1,m.saveFailed("general",b),l.sendGoogleEvent(n.CAT_APP_ERROR,n.ACT_ERR_SERVER,"General/Person saved failed"),k.sendMouseflowFormFailure("#generalInfoForm")},a.initPage=function(b,c){a.htmlForm=b,a.formConfig.isZdh=c,a.formConfig.webReferrer=k.getWebReferrer(),a.$emit("Global.IsZdhSet",c),a.loanType=h.loanType,a.isAndroid=h.isAndroid,"car-loan"==a.loanType&&(a.formConfig.minLoanAmount=3e3,a.formConfig.maxLoanAmount=19500,a.formConfig.maxLoanShowAmount=25e4,a.formConfig.sliderValueList=a.carSliderValueList,a.modelGeneral.amount=3e3,a.modelGeneral.loanType=a.formConfig.loanTypeCar),"holiday-apply"==a.loanType&&(a.modelGeneral.loanType=a.formConfig.loanTypeHoliday),a.modelGeneral.searchPhrase=k.getSearchTerm(),a.modelGeneral.googleClickID=k.getGoogleClickId(),a.modelGeneral.keywords=k.getKeywords(),a.modelGeneral.referringSourceDetail+=a.formConfig.webReferrer,k.getGoogleAnalyticsId(a.setAnalyticsId),a.formConfig.hideSlider=$(".inpage-calc").length>0;try{var d=g.search().src;if((void 0==d||0===d.length)&&(d=g.search().utm_source),void 0==d||0===d.length){var f=k.getSearchTerm();f&&(f=decodeURIComponent(f),d=f.split("|")[1].replace(" source: ",""))}if(void 0!=d&&d.length>0)switch(d){case"facebook":case"fb":a.modelGeneral.referringSourceDetail="Facebook Ad",a.modelGeneral.referringSource=a.formConfig.socialMediaSource,a.formConfig.hideSourceSelection=!0,void 0!=dataLayer&&dataLayer.push({event:"fb_origin"});break;case"ndc":a.modelGeneral.referringSourceDetail="Newsletter campaign",a.modelGeneral.referringSource=a.formConfig.promotionSource,a.formConfig.hideSourceSelection=!0;break;default:var i=parseInt(d);i!==0/0&&i>0&&(a.modelGeneral.referringSourceDetail="",a.modelGeneral.referringSource=i,a.formConfig.hideSourceSelection=!0)}e(function(){a.parseQueryString()})}catch(j){l.logEvent("page.error",{message:"Failed to collect utm source information",error:j})}if(c){var m=g.search().dest;null!=m&&m.length>0&&(a.modelGeneral.zdhDestination=m.toUpperCase(),g.url(g.path()))}l.sendGoogleEvent(n.CAT_UI_PROGRESS,n.ACT_APP_START,n.LBL_APP_LOADED)},a.isPastClient=function(){return a.modelGeneral.referringSource==a.formConfig.pastClientSource||a.modelGeneral.referringSource==a.formConfig.alternativePastClientSource},a.validateDate=function(b,c,d){a.debug.console+=" Validate called with "+b.$viewValue+" model: "+d+" source "+c+"\n",a.debug.validateCalled=!0;var e="";null!=b.$viewValue&&b.$viewValue.length>0&&(e=b.$viewValue.replace(/Y/g,"").replace(/M/g,"").replace(/D/g,""));-1!==b.$name.toLowerCase().indexOf("dob");if(!b.$dirty)return!0;if(!a.isOzDateFormat(e))return b.$setValidity("pattern",!1),l.sendGoogleEvent(n.CAT_UI_ERROR,n.ACT_ERR_DOB,n.LBL_ERR_DATE_FORMAT),l.logEvent("ui.error",{message:"Invalid date format "+e+" Field model value: "+b.$modelValue+" Model value: "+d+".\n"+JSON.stringify(a.modelPerson)}),!1;if(b.$setValidity("pattern",!0),b.$setValidity("invalidDate",!0),-1!=b.$name.toLowerCase().indexOf("dob")){var f=a.getOzDate(e);if(f<a.modelPerson.minDob||f>a.modelPerson.maxDob)return b.$setValidity("invalidDate",!1),l.logEvent("ui.error.dob",{message:"Invalid age "+e}),l.sendGoogleEvent(n.CAT_UI_ERROR,n.ACT_ERR_DOB,n.LBL_ERR_DOB),!1}return!0},a.parseQueryString=function(){var b=g.search(),c=!1,d={};Object.keys(b).forEach(function(a){d[a.toLowerCase().replace(/-/g,"")]=b[a]});var e=d.partial;void 0!==e&&e.length>0&&(a.formConfig.partialCompletion=!0);var f=d.firstname;void 0!==f&&f.length>0&&(a.modelPerson.firstName=f,c=!0);var h=d.lastname;void 0!==h&&h.length>0&&(a.modelPerson.lastName=h,c=!0);var i=d.middlename;void 0!==i&&i.length>0&&(a.modelPerson.middleName=i,c=!0);var j=d.email;void 0!==j&&j.length>0&&(a.modelPerson.email=j,c=!0);var k=d.contactnumber;void 0!==k&&k.length>0&&(a.modelPerson.contactNumber=k,c=!0);var l=d.title;void 0!==l&&l.length>0&&(a.modelPerson.title=l,c=!0);var m=d.marritalstatus;void 0!==m&&m.length>0&&(a.modelPerson.marritalStatus=m,c=!0);var n=d.repayment;void 0!==n&&n.length>0&&(a.formConfig.repaymentAmount=parseFloat(parseFloat(n).toFixed(2)));var o=d.term;void 0!==o&&o.length>0&&(a.formConfig.repaymentTerm=parseInt(o));var p=d.amount;void 0!==p&&p.length>0&&(a.modelGeneral.amount=parseInt(p),a.formConfig.hideSlider||(a.formConfig.sliderAmount=parseInt(p)));var q=d.api;void 0!==q&&q.length>0&&(a.modelGeneral.apiId=parseInt(q));var r=d.agesofdependants;void 0!==r&&r.length>0&&(a.modelPerson.numberOfDependants=parseInt(r),c=!0);var s=d.driverlicense;void 0!==s&&s.length>0&&(a.modelPerson.driverLicense=s,c=!0);var t=d.driverlicensestate;void 0!==t&&t.length>0&&(a.modelPerson.driverLicenseState=t,c=!0);var u=d.medicarenumber;void 0!==u&&u.length>0&&(a.modelPerson.medicareNumber=u,c=!0);var v=d.medicarereference;void 0!==v&&v.length>0&&(a.modelPerson.mcRefNo=parseInt(v),c=!0);var w=d.webReferrer;void 0!==w&&w.length>0&&(a.formConfig.webReferrer=decodeURIComponent(w));var x=d.referringsource;if(void 0!==x&&x.length>0){var y=parseInt(x);y!==0/0&&y>0&&(a.modelGeneral.referringSourceDetail="",a.modelGeneral.referringSource=y,a.formConfig.hideSourceSelection=!0)}var z=d.referringsourcedetail;void 0!==z&&z.length>0&&(a.modelGeneral.referringSourceDetail=z,c=!0);var A=d.loanpurpose;void 0!==A&&A.length>0&&(a.modelGeneral.loanPurposeValue=""+a.formConfig.loanPurposeOtherVal,a.modelGeneral.loanPurposeOther=A,c=!0);var B=d.dob;if(void 0!==B&&B.length>0){var C=parseInt(B.substring(0,4)),D=parseInt(B.substring(5,7)),E=parseInt(B.substring(8,11));a.modelPerson.dob=new Date(C,D-1,E),c=!0}a.formConfig.sliderEnabled=!0,c&&(a.htmlForm.$submitted=!0)},a.validateCoBorrower=function(){return a.modelPerson.contactNumber.length>0&&a.modelPerson.firstName.length>0&&a.modelPerson.lastName.length>0&&a.modelPerson.contactNumber===a.modelCoPerson.contactNumber&&a.modelPerson.lastName.toLowerCase()===a.modelCoPerson.lastName.toLowerCase()&&a.modelPerson.firstName.toLowerCase()===a.modelCoPerson.firstName.toLowerCase()&&void 0===a.htmlForm.$error.sameBorrower?(l.logEvent("ui.error.same-co-borrower",{message:"Same detail for principal and co-borrower entered "}),a.htmlForm.$setValidity("sameBorrower",!1),a.formConfig.errorSameBorrower=(a.formConfig.isZdh?"Co-applicant ":"Co-borrower")+" must be a different person living with you at the same address",!1):(a.htmlForm.$setValidity("sameBorrower",!0),!0)},a.validatePerson=function(){if(a.modelPerson.contactNumber.length>0&&a.modelPerson.email.length>0){var b=j.checkPerson(a.modelPerson.email,a.modelPerson.contactNumber);b.$promise.then(a.validatePersonPassed,a.validatePersonFailed)}},a.validateDob=function(b,c){b<a.modelPerson.minDob||b>a.modelPerson.maxDob?(c.$setValidity("invalidDate",!1),l.logEvent("ui.error.dob",{message:"Invalid age "+b})):c.$setValidity("invalidDate",!0)},a.validatePersonFailed=function(a){l.logEvent("ui.error.validation.person",{message:"Failed to validate personal details: "+a})},a.validatePersonPassed=function(b){b.isValid?a.htmlForm.$setValidity("validBorrower",!0):(l.logEvent("ui.error.validation.person",{message:"This person failed to pass server validation "+a.modelPerson.email+" "+a.modelPerson.contactNumber}),a.htmlForm.$setValidity("validBorrower",!1))},a.holdingCointainerClass=function(a,b){return l.holdingCointainerClass(a,b)},a.errorsVisible=function(a,b){return l.errorsVisible(a,b)},a.formatAmount=function(b){return a.decodeSliderValue(b)},a.getPurposeLabel=function(){return"mini-loan"===a.loanType||"loan"===a.loanType?"Purpose of Loan":"car-loan"===a.loanType?"Vehicle Make/Model":("holiday-apply"===a.loanType,"")},a.amountChanged=function(b,c){a.modelGeneral.amount=b;for(var d=a.repayments,e=0;e<d.length;e++)d[e].amount==b&&a.updateTerms(d[e].term[0]);2e3>=b&&!a.formConfig.warningShown&&("undefined"!=typeof ga&&ga("send","event","Warnings","Show","Goverment warning shown"),c&&(a.formConfig.warningShown=!0,a.showGovtWarning()))},a.showGovtWarning=function(){i.open({templateUrl:h.apiLocation+"templates/govtWarning.html",controller:"GovtWarningController",size:"lg",keyboard:!0,windowClass:"z1080",resolve:{loanType:function(){return a.loanType}}})},a.dlChanged=function(a){d.info(a)},a.noLicense=function(a){a.haveLicense=!1,a.driverLicense=null,a.dlState=null,a.dlExpiryMonth=null,a.dlExpiryYear=null},a.updateAmount=function(b){e(function(){a.modelGeneral.amount=b})},a.updateTerms=function(b){e(function(){a.formConfig.repaymentAmount=parseFloat(b.repayment).toFixed(2),a.formConfig.repaymentTerm=b.term})},a.setAnalyticsId=function(b){"undefined"==typeof b||null==b||0==b.length||-1!==b.indexOf("ERR:")?l.logEvent("ui.err.ga-notfound",{message:"Failed to get GA UID "+JSON.stringify(a.modelGeneral),error:b}):a.modelGeneral.googleAnalyticsId=b},a.setCoBorrower=function(){a.modelGeneral.hasCoBorrower=!a.modelGeneral.hasCoBorrower,l.sendGoogleEvent(n.CAT_UI_PROGRESS,n.ACT_ADD_COBORROWER,a.modelGeneral.hasCoBorrower?"Added CoBorrower":"Removed CoBorrower")},a.noMedicare=function(a){a.haveLicense=!0,a.medicareNumber=null,a.mcRefNo=null,a.mcExpiryMonth=null,a.mcExpiryYear=null},a.openDob=function(b,c){b.preventDefault(),b.stopPropagation(),c?a.modelCoPerson.dobOpened=!0:a.modelPerson.dobOpened=!0},a.openDeparture=function(b){b.preventDefault(),b.stopPropagation(),a.modelGeneral.departureOpened=!0},a.getLoanType=function(a){return-1!=a.toLowerCase().indexOf("car")?"Car":-1!=a.toLowerCase().indexOf("holiday")?"Holiday":"Cash"},a.getHint=function(b){return a.formConfig.isZdh&&(b=b.replace("Borrower","ZdhBorrower")),l.getHint(b,a.hints)},a.$emit("Global.LoanTypeSet",h.loanType),b.getTitles().then(function(b){a.titles=b},function(a){d.error("Failed to load titles from server:\n"+a)}),b.getRepayments(a.getLoanType(h.loanType)).$promise.then(function(b){a.repayments=b},function(a){d.error("Failed to load repayments from server:\n"+a)}),a.contactTimes=b.getCallTimes(),a.maritalStatuses=b.getMaritalStatuses(),a.stateNumericList=b.getCountryStates(!1),a.referringSources=b.getReferringSources(),a.loanPurposes=b.getLoanPurposes(),a.isPurposeVisible=function(){return"car-loan"==a.loanType?(a.modelGeneral.loanPurposeValue=a.formConfig.loanPurposeOtherVal,!1):!0},a.showRefSource=function(){return!(a.formConfig.hideSourceSelection||void 0!=a.modelGeneral.referringSource&&null!=a.modelGeneral.referringSource&&(a.modelGeneral.referringSource!==a.formConfig.promotionSource||a.modelGeneral.referringSource!==a.formConfig.socialMediaSource)&&a.modelGeneral.referringSourceDetail.length>0&&a.modelGeneral.referringSourceDetail!==a.formConfig.webReferrer)},a.showSourceButton=function(b){return b==a.formConfig.promotionSource&&a.modelGeneral.referringSource!=a.formConfig.promotionSource},a.hints={miniloanpurposePlace:"Type your purpose",miniloanpurposetip:"Please specify what other purpose is",miniloanpurpose:"Please choose what you will use the Loan Funds for",carloanpurposePlace:"Make and model or 'Not decided'",maritalStatus:"Please choose your marital status",numberOfDependants:"Please enter how many dependents you have, put 0 if you have none",carloanpurposetip:"",carloanpurpose:"Please write vehicle make and model that you would like to purchase. If undecided write 'Not decided' ",phone:"Enter your best contact number starting with 04 for mobile or 02,03,07,08 for Landline",contactTime:"Select which time suits you best for us to call",emailBorrower:"Please enter your email address. This will be used for confirmation emails, Loan documents and marketing",emailZdhBorrower:"Please enter your email address. This will be used for confirmation emails, paperwork and marketing",source:"Please select how you found Safe Financial",sourcezdh:"Please select how you found Zero Deposit Holidays",addCoBorrower:"You can add an eligible Co-borrower if the loan funds are for two people and you are living together",addCoZdhBorrower:"You can add an eligible Co-applicant if you are going to travel together",driverLicence:"Click '!' button next to this field if you don’t have an Australian driver's licence",medicareNo:"As you don't have a driver's licence, please provide your Medicare card number",zdhDestination:"Choose where would you like to go for holidays",zdhCity:"Choose which city you are going to fly from",zdhAges:"Please enter separated by comma ages of children (2 to 11 years old) travelling with you",zdhTravellers:"If you have more than 5 people, who would like to travel please click 5+ button",zdhDays:"At this point, we have holidays with the following number of nights.  For other options, please give us a call.",addCoBorrowerButton:"Co-Borrower",addCoZdhBorrowerButton:"Travel Companion",coBorrowerEmailLabel:"Co-Borrower Email address",coZdhBorrowerEmailLabel:"Co-Applicant Email address",coBorrowerEmailPh:"Co-Borrower Email address",coZdhBorrowerEmailPh:"Co-Applicant Email address",coBorrowerTitle:"Co-Borrower Title",coZdhBorrowerTitle:"Co-Applicant Title",coBorrowerTitleTip:"Choose your co-borrower's title",coZdhBorrowerTitleTip:"Choose your co-applicant's title",coBorrowerFnameLabel:"Co-Borrower First Name",coZdhBorrowerFnameLabel:"Co-Applicant First Name",coBorrowerFnamePh:"Co-Borrower First Name",coZdhBorrowerFnamePh:"Co-Applicant First Name",coBorrowerMnameLabel:"Co-Borrower Middle Name",coZdhBorrowerMnameLabel:"Co-Applicant Middle Name",coBorrowerMnamePh:"Co-Borrower Middle Name",coZdhBorrowerMnamePh:"Co-Applicant Middle Name",coBorrowerLnameLabel:"Co-Borrower Last Name",coZdhBorrowerLnameLabel:"Co-Applicant Last Name",coBorrowerLnamePh:"Co-Borrower Last Name",coZdhBorrowerLnamePh:"Co-Applicant Last Name",coBorrowerDobLabel:"Co-Borrower Date Of Birth",coZdhBorrowerDobLabel:"Co-Applicant Date Of Birth",coBorrowerContactNoLabel:"Co-Borrower Contact No",coZdhBorrowerContactNoLabel:"Co-Applicant Contact No",coBorrowerDLicenseTip:"Click here if co-borrower doesn't have Australian Drivers Licence",coZdhBorrowerDLicenseTip:"Click here if co-applicant doesn't have Australian Drivers Licence",coBorrowerMcareHint:"As co-borrower doesn't have Drivers Licence please provide Mediare Card Number",coZdhBorrowerMcareHint:"As co-applicant doesn't have Drivers Licence please provide Mediare Card Number",coBorrowerMcareBtn:"Click here if co-borrower doesn't have Medicare Card, but have Australian Drivers Licence",coZdhBorrowerMcareBtn:"Click here if co-applicant doesn't have Medicare Card, but have Australian Drivers Licence"},a.expiryYearList=[];for(var o=(new Date).getFullYear();o<(new Date).getFullYear()+10;o++)a.expiryYearList.push({value:o+"",text:o+""});a.formDisabled=!1,a.expiryMonthList=[{value:"1",text:"01"},{value:"2",text:"02"},{value:"3",text:"03"},{value:"4",text:"04"},{value:"5",text:"05"},{value:"6",text:"06"},{value:"7",text:"07"},{value:"8",text:"08"},{value:"9",text:"09"},{value:"10",text:"10"},{value:"11",text:"11"},{value:"12",text:"12"}],a.zdhDaysList=[{value:"5",text:"5"},{value:"6",text:"6"},{value:"7",text:"7"},{value:"8",text:"8"},{value:"9",text:"9"},{value:"10",text:"10"}],a.zdhPaxNoList=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"},{value:"5+",text:"5+"}],a.zdhCityList=[{value:"BNE",text:"Brisbane"},{value:"SYD",text:"Sydney"},{value:"MEL",text:"Melbourne"},{value:"ADE",text:"Adelaide"},{value:"PER",text:"Perth"},{value:"DAR",text:"Darwin"},{value:"HOB",text:"Hobart"},{value:"CAI",text:"Cairns"}],a.zdhDestinationList=[{value:"BALI",text:"Bali"},{value:"FIJI",text:"Fiji"},{value:"GC",text:"Gold Coast"},{value:"NZ",text:"New Zealand"},{value:"THAI",text:"Thailand"},{value:"TNQ",text:"Whitsundays"}],a.carSliderValueList=[{value:1e3,text:"$1,000"},{value:1500,text:"$1,500"},{value:2e3,text:"$2,000"},{value:2500,text:"$2,500"},{value:3e3,text:"$3,000"},{value:3500,text:"$3,500"},{value:4e3,text:"$4,000"},{value:4500,text:"$4,500"},{value:5e3,text:"$5,000"},{value:5500,text:"$5,500"},{value:6e3,text:"$6,000"},{value:6500,text:"$6,500"},{value:7e3,text:"$7,000"},{value:7500,text:"$10,000"},{value:8e3,text:"$20,000"},{value:8500,text:"$30,000"},{value:9e3,text:"$40,000"},{value:9500,text:"$50,000"},{value:1e4,text:"$60,000"},{value:10500,text:"$70,000"},{value:11e3,text:"$80,000"},{value:11500,text:"$90,000"},{value:12e3,text:"$100,000"},{value:12500,text:"$110,000"},{value:13e3,text:"$120,000"},{value:13500,text:"$130,000"},{value:14e3,text:"$140,000"},{value:14500,text:"$150,000"},{value:15e3,text:"$160,000"},{value:15500,text:"$170,000"},{value:16e3,text:"$180,000"},{value:16500,text:"$190,000"},{value:17e3,text:"$200,000"},{value:17500,text:"$210,000"},{value:18e3,text:"$220,000"},{value:18500,text:"$230,000"},{value:19e3,text:"$240,000"},{value:19500,text:"$250,000"}],a.loanSliderValueList=[{value:1e3,text:"$1,000"},{value:1500,text:"$1,500"},{value:2e3,text:"$2,000"},{value:2500,text:"$2,500"},{value:3e3,text:"$3,000"},{value:3500,text:"$3,500"},{value:4e3,text:"$4,000"},{value:4500,text:"$4,500"},{value:5e3,text:"$5,000"}],a.decodeSliderValue=function(b){for(var c=0;c<a.formConfig.sliderValueList.length;c++)if(a.formConfig.sliderValueList[c].value==b)return a.formConfig.sliderValueList[c].text;return""},a.formConfig={hideSourceSelection:!1,hideJointButton:!0,hideSlider:!1,minLoanAmount:1e3,maxLoanAmount:5e3,maxLoanShowAmount:5e3,amountStep:500,partialCompletion:!1,sliderEnabled:!1,sliderAmount:1e3,socialMediaSource:890,promotionSource:1,pastClientSource:897,alternativePastClientSource:491,sliderValueList:a.loanSliderValueList,warningShown:!1,deferredSave:null,repaymentAmount:"",repaymentTerm:0,dateFormat:"dd/MM/yyyy",emailPattern:/^[_A-z0-9-]+(\.[-_A-z0-9]+)*@[A-z0-9-]+(\.[A-z0-9-]+)*(\.[A-z]{2,4})$/,formSaved:!1,borrowerSaved:!1,coBorrowerSaved:!1,htmlForm:null,serverErrors:[],formError:"Information above is not valid, please correct errors",errorSameBorrower:"",errorInvalidBorrower:"It appears these details are already in our system. Please call 1300 661 991 regarding your application.",isBeingSaved:!1,newApp:!0,loanPurposeOtherVal:104,loanTypeCash:0,loanTypeCar:1,loanTypeHoliday:3,webReferrer:"",isZdh:!1},a.modelGeneral={applicationId:0,apiId:0,amount:1e3,loanPurpose:"",loanPurposeValue:null,loanPurposeOther:"",referringSource:null,referringSourceDetail:"",hasCoBorrower:!1,searchPhrase:"",keywords:"",googleClickID:"",googleAnalyticsId:"",clientKey:"",loanType:a.formConfig.loanTypeCash,zdhDeparture:null,zdhPaxNo:null,zdhDestination:"",zdhCity:"",zdhAges:"",zdhDays:null,minDeparture:new Date,maxDeparture:new Date((new Date).getFullYear()+1,(new Date).getMonth(),(new Date).getDay()),departureOpened:!1,departureDateOptions:{startingDay:1,showWeeks:!1}},a.modelPerson={applicationId:0,isCoBorrower:!1,firstName:"",lastName:"",title:"",middleName:"",contactTime:"",contactNumber:"",contactNumberType:1,email:"",gender:"True",dob:null,dobString:"",driverLicense:null,dlState:null,dlExpiryYear:null,dlExpiryMonth:null,marritalStatus:null,numberOfDependants:null,medicareNumber:null,mcRefNo:null,mcExpiryYear:null,mcExpiryMonth:null,haveLicense:!0,dobInitial:new Date((new Date).getFullYear()-20,(new Date).getMonth(),(new Date).getDay()),minDob:new Date((new Date).getFullYear()-90,(new Date).getMonth(),(new Date).getDay()),maxDob:new Date((new Date).getFullYear()-18,(new Date).getMonth(),(new Date).getDay()),dobOpened:!1,clientKey:"",dobDateOptions:{startingDay:1,initDate:new Date((new Date).getFullYear()-25,(new Date).getMonth(),(new Date).getDay()),showWeeks:!1}},a.modelCoPerson=angular.copy(a.modelPerson),a.modelCoPerson.isCoBorrower=!0,a.model={config:a.formConfig,general:a.modelGeneral,person:a.modelPerson,coPerson:a.modelCoPerson},a.fillTest=function(){var b=Math.floor(1e3*Math.random(),2);a.modelGeneral.amount=3e3,a.modelGeneral.loanPurpose=a.loanPurposes[0].text,a.modelGeneral.loanPurposeValue=a.loanPurposes[0].value,a.modelGeneral.referringSource=a.referringSources[0].value,a.modelPerson.firstName="Andre",a.modelPerson.lastName="Test",a.modelPerson.title=a.titles[1].value,a.modelPerson.contactTime=a.contactTimes[0].value,a.modelPerson.contactNumber="0414 366 867",a.modelPerson.email="test"+b.toString()+"@safefinancial.com.au",a.modelPerson.dob=new Date(1989,11,11),a.modelPerson.driverLicense="123456789",a.modelPerson.dlState=a.stateNumericList[0].value,a.modelPerson.dlExpiryYear="2021",a.modelPerson.dlExpiryMonth="10",a.modelPerson.marritalStatus=a.maritalStatuses[0].value,a.modelPerson.numberOfDependants=0},a.getOzDate=function(a){try{if(a instanceof Date)return a;var b=a.split("/");if(3!=b.length)return null;var c=new Date(parseInt(b[2]),parseInt(b[1])-1,parseInt(b[0]));return c}catch(d){return null}},a.isOzDateFormat=function(a){return"string"==typeof a?null!=a.match(/^(([0-2]?\d{1})|([3][0,1]{1}))\/[0,1]?\d{1}\/(([1]{1}[9]{1}[2-9]{1}\d{1})|([2-9]{1}\d{3}))$/):!0},a.tryParseDate=function(b){if("string"==typeof b){var c=null;if(a.isOzDateFormat(b))return c=new Date(parseInt(b.substring(6,10)),parseInt(b.substring(3,5),parseInt(b.substring(0,2))));b=b.replace(" ","");var d="";if(8==b.length&&(d=b.substring(0,2)+"/"+b.substring(2,4)+"/"+b.substring(4,8),a.isOzDateFormat(d)))return c=new Date(parseInt(b.substring(4,8)),parseInt(b.substring(2,4),parseInt(b.substring(0,2))));if(6==b.length&&(d="0"+b.substring(0,1)+"/0"+b.substring(1,2)+"/"+b.substring(2,6),a.isOzDateFormat(d)))return c=new Date(parseInt(d.substring(6,10)),parseInt(d.substring(3,5),parseInt(d.substring(0,2))))}return null},a.$watch("modelPerson.contactNumber",function(b,c){a.modelPerson.contactNumberType=b&&b.length>1&&0===b.indexOf("04")?1:2,b!==c&&b&&b.length>1&&-1!==b.indexOf(" ")&&(a.modelPerson.contactNumber=b.replace(/ /g,""))}),a.$watch("modelGeneral",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1),a.htmlForm.$dirty&&a.formConfig.sliderEnabled&&a.amountChanged(a.modelGeneral.amount,!0)},!0),a.$watch("modelPerson",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelCoPerson",function(){null!=a.htmlForm.$error.serverSide&&a.htmlForm.$setValidity("serverSide",!0),a.formConfig.formSaved&&(a.formConfig.formSaved=!1)},!0),a.$watch("modelGeneral.hasCoBorrower",function(b,c){a.$emit("Global.HasCoBorrowerSet",b),b?a.htmlForm.$setPristine():c&&a.htmlForm.$setSubmitted()}),a.$watch("formConfig.sliderAmount",function(b){b&&a.formConfig.sliderEnabled&&a.amountChanged(b,!0)}),a.$watch("modelCoPerson.dlExpiryYear",function(a,b){(null!=a||null!=b)&&m.validateForm("general")}),a.$watch("modelCoPerson.mcExpiryYear",function(a,b){(null!=a||null!=b)&&m.validateForm("general")}),a.$watch("modelPerson.dlExpiryYear",function(b,c){0!=a.modelGeneral.hasCoBorrower||null==b&&null==c||m.validateForm("general")}),a.$watch("modelPerson.mcExpiryYear",function(b,c){0!=a.modelGeneral.hasCoBorrower||null==b&&null==c||(m.validateForm("general"),l.sendGoogleEvent(n.CAT_GOAL,n.ACT_PERSONAL_DONE,n.LBL_COMPLETED_PERSONAL))}),a.$watch("modelCoPerson.mcExpiryYear",function(b,c){0!=a.modelGeneral.hasCoBorrower||null==b&&null==c||(m.validateForm("general"),l.sendGoogleEvent(n.CAT_GOAL,n.ACT_PERSONAL_DONE,n.LBL_COMPLETED_CO_PERSONAL))}),a.$watch("modelPerson.title",function(b){a.modelPerson.gender="Mr"==b?"True":"False"}),a.$watch("modelCoPerson.title",function(b){a.modelCoPerson.gender="Mr"==b?"True":"False"}),a.$watch("modelPerson.firstName",function(b,c){null!=b&&b.length>0&&(a.$emit("Global.BorrowerNameSet",b),(null==c||0==c.length)&&l.sendGoogleEvent(n.CAT_GOAL,n.ACT_GENERAL_DONE,n.LBL_COMPLETED_GENERAL))}),a.$watch("modelGeneral.referringSource",function(){a.$emit("Global.IsPastClient",a.isPastClient())}),a.$watch("modelPerson.contactNumber",function(b,c){null!=b&&b.length>0&&(a.$emit("Global.BorrowerPhoneSet",b),(null==c||0==c.length)&&l.sendGoogleEvent(n.CAT_GOAL,n.ACT_GENERAL_DONE,n.LBL_COMPLETED_GENERAL))}),a.getAge=function(a,b){return b=b||new Date,b.getFullYear()-a.getFullYear()-(b.getMonth()<a.getMonth()||b.getMonth()==a.getMonth()&&b.getDate()<a.getDate()?1:0)},a.$watch("modelPerson.dob",function(b){null!=b&&(a.validateDob(b,a.htmlForm.DOB),b instanceof Date&&(a.$emit("Global.BorrowerAgeSet",a.getAge(b)),a.modelPerson.dobString=b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()))}),a.$watch("modelCoPerson.dob",function(b){a.debug.changeCalled=!0,a.debug.console+=" Change called with "+b+"\n",null!=b&&(a.validateDob(b,a.htmlForm.CoDOB),b instanceof Date&&(a.$emit("Global.CoBorrowerAgeSet",a.getAge(b)),a.modelCoPerson.dobString=b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()))}),a.$watch("modelCoPerson.contactNumber",function(b){void 0!==b&&null!=b&&b.length>0&&a.validateCoBorrower()}),a.$watch("modelCoPerson.lastName",function(b){void 0!==b&&null!=b&&b.length>0&&a.validateCoBorrower()}),a.$watch("modelCoPerson.firstName",function(b){void 0!==b&&null!=b&&b.length>0&&a.validateCoBorrower()}),a.$watch("modelPerson.contactNumber",function(b){void 0!==b&&null!=b&&b.length>0&&a.validatePerson()}),a.$watch("modelPerson.email",function(b){void 0!==b&&null!=b&&b.length>0&&a.validatePerson()}),a.$watch("modelPerson.dob",function(b){void 0!==b&&null!=b&&a.validateDob(b,a.htmlForm.DOB)}),a.$watch("modelPerson.numberOfDependants",function(b){void 0!==b&&null!=b&&(a.modelCoPerson.numberOfDependants=b)}),a.$watch("modelPerson.marritalStatus",function(b){void 0!==b&&null!=b&&(a.modelCoPerson.marritalStatus=b,a.formConfig.hideJointButton="1"===b||"6"===b||"7"===b||"8"===b)}),a.$watch("modelCoPerson.dob",function(b){void 0!==b&&null!=b&&a.validateDob(b,a.htmlForm.CoDOB)}),a.timeout=function(a){e(a)},a.debug={console:"",changeCalled:!1,validateCalled:!1}}])}();;
!function(){var a=angular.module("loanApp");a.factory("generalRepository",["$resource","bootstrappedData",function(a,b){return{saveGeneral:function(c){var d=a(b.apiLocation+"api/general").save(c);return d},checkPerson:function(c,d){var e=a(b.apiLocation+"api/general/check-person").save({email:encodeURIComponent(c),phone:d});return e},savePerson:function(c,d){return a(b.apiLocation+"api/general/person/:clientKey",{clientKey:d}).save(c)}}}])}();