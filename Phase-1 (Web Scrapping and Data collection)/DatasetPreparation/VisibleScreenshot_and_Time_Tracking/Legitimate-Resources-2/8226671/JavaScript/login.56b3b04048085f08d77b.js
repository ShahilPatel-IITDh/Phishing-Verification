(window.webpackJsonp=window.webpackJsonp||[]).push([["login",492,493],{1990:function(e,t,r){e.exports=r.p+"user-default-thumb-b3d436d05d2f98bf8909e444d7ae970a2267a03eb44737a53089be72ecbdec94.png"},1991:function(e,t,r){e.exports=r.p+"user-default-small-29ab90800239d98a918d9f98d474643c6ef0f0a73f19366e27f00cdc7292ebb6.png"},1992:function(e,t,r){e.exports=r.p+"user-default-35e1ec4d339f17511a65b8998e01c674b132983e1cd524cec1bd848a2a2e189f.png"},1993:function(e,t,r){"use strict";var a=r(0),n=r.n(a),i=r(75),o=r.n(i),s=r(13),c=r.n(s),u=r(26),l=r.n(u),d=r(136),p=r(306),h=r(1992),m=r.n(h),f=r(1991),g=r.n(f),_=r(1990),b=r.n(_);t.a={generateUserImageURL:function(e,t){var r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"thumb";if(!e)if(t)switch(e=n()(r=n()(a="".concat(d.a.facebook.graphUrl,"/")).call(a,d.a.facebook.graphVersion,"/")).call(r,t,"/picture"),i){case"medium":e+="?width=580&height=580";break;case"small":e+="?width=300&height=300";break;case"smaller":e+="?width=250&height=250";break;case"thumb":e+="?width=100&height=100"}else switch(i){case"small":e=g.a;break;case"thumb":e=b.a;break;default:e=m.a}return e},getValueFromMoney:function(e){return e&&e.val&&o()(e.val)},getCreditCardTypeClassByType:function(e){switch(e){case p.a.creditCardType.VISA:return"visa";case p.a.creditCardType.AMEX:return"ae";case p.a.creditCardType.MASTERCARD:return"mc";case p.a.creditCardType.DISCOVER:return"discover";case p.a.creditCardType.JCB:return"jcb";default:return"cc"}},getDomainBasedI18n:function(e,t){var r=e&&c()(e);return r?l()(r).call(r,t)?e[t]:e.default:e}}},2227:function(e,t,r){"use strict";var a=r(0),n=r.n(a),i=r(241),o=r.n(i),s=r(8);t.a={isValidPmRdUrl:function(e,t){if(e){var r,a=n()(r="".concat(s.a.appScheme,"://")).call(r,s.a.domain[t]),i=new o.a(e,a);return i.pathname&&i.origin&&i.origin===a}return!1}}},2666:function(e,t,r){var a=r(3334);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r(398).default)("671b3076",a,!0,{})},3333:function(e,t,r){"use strict";r(2666)},3334:function(e,t,r){(t=r(305)(!1)).push([e.i,'.login{max-width:525px}.login__footer{border-top:1px solid #e6e2df;margin-top:40px;padding-top:16px;text-align:center}.login__button-con{margin:0 -20px/2}.login__modal__button-con{max-width:326px}.login__button{margin:8px 0;padding:0 20px/2}.login__button--mobile{margin-bottom:12px !important}.divider_text{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;-webkit-box-align:center;align-items:center;margin:32px 0;text-align:center;color:#9b9691}.divider_text::before,.divider_text::after{content:"";-ms-flex:1 1 auto;-webkit-box-flex:1;flex:1 1 auto;border-bottom:1px solid #d9d5d2}.divider_text::before{margin-right:12px}.divider_text::after{margin-left:12px}',""]),e.exports=t},4543:function(e,t,r){"use strict";r.r(t);var a=r(13),n=r.n(a),i=r(21),o=r.n(i),s=r(17),c=r.n(s),u=r(22),l=r.n(u),d=r(11),p=r.n(d),h=r(23),m=r.n(h),f=r(32),g=r.n(f),_=r(30),b=r.n(_),x=r(2),v=r.n(x),w=r(20),y=r.n(w),C=r(1),k=r.n(C),E=r(103),$=r.n(E),A=r(15),I=r.n(A),U=r(26),S=r.n(U),T=r(34),P=r.n(T),q=r(399),M=r(43),D=r(2035),R=r(5),j=r(25),F=r(2227),L=r(104),B=r(6),O=r(243),V=r(1533),N=r(1993);function H(e,t){var r=n()(e);if(o.a){var a=o()(e);t&&(a=c()(a).call(a,(function(t){return l()(e,t).enumerable}))),r.push.apply(r,a)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r,a,n=null!=arguments[t]?arguments[t]:{};t%2?p()(r=H(Object(n),!0)).call(r,(function(t){y()(e,t,n[t])})):m.a?g()(e,m()(n)):p()(a=H(Object(n))).call(a,(function(t){b()(e,t,l()(n,t))}))}return e}var z={name:"Login",components:{SignUpIcons:function(){return r.e(17).then(r.bind(null,4459))},PmTextField:q.p,PmForm:function(){return r.e(6).then(r.bind(null,2562))},AuthCaptcha:function(){return r.e(8).then(r.bind(null,4661))},CrossDomainBanner:function(){return r.e(167).then(r.bind(null,4797))},SelectEmail:function(){return r.e(539).then(r.bind(null,4798))},PhoneAuthentication:function(){return r.e(894).then(r.bind(null,2992))},StaySignedIn:function(){return r.e(30).then(r.bind(null,2991))}},data:function(){return{userHandle:"",password:"",bannerError:"",showCaptcha:!1,captchaResponse:"",hideCrossDomainBanner:!1}},computed:J(J(J(J({},Object(M.e)("$_auth",{externalEmailData:function(e){return e.externalEmailData},error:function(e){return e.loginError}})),Object(M.e)({isUserLoggedIn:function(e){return e.auth.isUserLoggedIn},isMobile:function(e){return e.ua.isMobile},domain:function(e){return e.domain},userId:function(e){return e.auth.identity},userInfo:function(e){return e.userCookies.userInfo},showAutoCaptcha:function(e){return e.showAutoCaptcha}})),Object(M.c)(["ipDomain"])),{},{isCrossDomainVisitor:function(){return this.ipDomain!==this.domain},isPhoneAuthenticationFlow:function(){return"in"===this.domain}}),asyncData:function(e){var t=this;return v()(k.a.mark((function r(){var a,n,i,o,s,c,u,l,d,p,h,m,f,g,_,b;return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=e.route,n=e.store,i=e.context,e.reject,o=e.i18n,n.registerPMModule("$_auth",Object(D.a)()),s=a.query&&a.query["pmrd[url]"],c=F.a.isValidPmRdUrl(s,n.state.domain)?s:L.a.feed.baseUrl,!n.state.auth.isUserLoggedIn){r.next=6;break}return r.abrupt("return",$.a.reject({code:302,url:c}));case 6:if(!i||!i.req||"POST"!==i.req.method){r.next=39;break}if(!(u=i.req.body&&i.req.body.login_form)){r.next=37;break}return u.username_email&&(u.user_handle=u.username_email),u.hasOwnProperty("stay_signed_in")&&(u.stay_signed_in="true"===u.stay_signed_in),r.next=13,n.dispatch("$_auth/loginUser",{context:i,params:u});case 13:if(!(l=n.state.$_auth.loginError)||!l.errorType){r.next=28;break}if("NotFoundError"!==l.errorType||!("ap"!==u.ext_service_id||"ap"===u.ext_service_id&&u.ext_user_info)){r.next=23;break}return u.ext_service_id&&(u.ext_access_token||u.ext_id_token)&&(d={ext_service_id:u.ext_service_id,ext_access_token:u.ext_access_token,ext_id_token:u.ext_id_token},p=(new Date).getTime()+18e5,i.res.cookie("ext_sign_up",I()(d),{httpOnly:!0,secure:!0,expires:new Date(p)})),h=a.query,m=J(J(J(J(J(J(J(J({page_type:h.page_type||"join_popup",ext_service_id:u.ext_service_id},"ap"===u.ext_service_id&&u.ext_user_info&&{ext_user_info:u.ext_user_info}),u.ap_code&&{ap_code:u.ap_code}),h.guest_user_token&&{guest_user_token:h.guest_user_token}),h.pmrd&&{pmrd:h.pmrd}),h["pmrd[url]"]&&{"pmrd[url]":h["pmrd[url]"]}),h.pii&&{pii:h.pii}),h.prsi&&{prsi:h.prsi}),h.ch&&{ch:h.ch}),f=R.a.generateUrlFromParamsAndAppendToUrl("/signup",m),r.abrupt("return",$.a.reject({url:f,code:302}));case 23:if("NotFoundError"!==l.errorType||"ap"!==u.ext_service_id||u.ext_user_info){r.next=26;break}return r.next=26,n.commit("$_auth/SetLoginError",{errorType:"AppleAuthorizationIssue",userMessage:o.t("errorMessages.appleAuthorizationIssue")});case 26:case 34:r.next=37;break;case 28:try{g=u.ext_user_info&&JSON.parse(u.ext_user_info)}catch(e){t.$loggerUtil.logger.error("Error parsing login form ext_user_info: ".concat(u.ext_user_info))}if(_=n.state.userCookies&&n.state.userCookies.userInfo&&n.state.userCookies.userInfo.em,b=n.state.userCookies&&n.state.userCookies.userInfo&&n.state.userCookies.userInfo.uid,"ap"!==u.ext_service_id||!g||g.email===_||!b){r.next=36;break}return r.next=34,n.commit("$_auth/SetExternalEmailData",{uid:b,ext_service_id:"ap",ext_id_token:u.ext_id_token,userEmail:_,externalEmail:g.email});case 36:return r.abrupt("return",$.a.reject({url:c,code:302}));case 37:r.next=45;break;case 39:if(!a.query||!a.query.token){r.next=45;break}return r.next=42,n.dispatch("$_auth/loginUser",{context:i,params:J({request_token:a.query.token},a.query.ssi&&{stay_signed_in:a.query.ssi})});case 42:if(n.state.$_auth.loginError){r.next=45;break}return r.abrupt("return",$.a.reject({url:c,code:302}));case 45:return r.next=47,n.dispatch("fetchFeatureSettings",{route:a,context:i,apiClient:B.a});case 47:case"end":return r.stop()}}),r)})))()},created:function(){(this.$store.registerPMModule("$_auth",Object(D.a)()),this.error)&&(this.$route.query&&this.$route.query.token?this.handleLoginError(this.error,!0):this.handleLoginError(this.error));this.invalidUsernamePasswordErrorMsg=this.$t("errorMessages.invalidUsernamePassword"),this.displayCaptchaErrorMsg=this.$t("errorMessages.displayCaptchaError"),this.defaultErrorMsg=this.$t("errorMessages.defaultError")},mounted:function(){this.isPhoneAuthenticationFlow?this.$eventTracker.pageView({screenName:"phone_number_login"}):this.setEventTrackingAttributes({screenName:j.a.screenName.login}),this.loadIovation(),V.a.$on("handleAutoCaptcha/login",this.handleAutoCaptcha)},beforeDestroy:function(){"$_auth"!==this.$route.meta.module&&this.$store.unregisterPMModule("$_auth")},methods:J(J(J({},Object(M.b)("$_auth",["loginUser","setError"])),Object(M.b)(["setEventTrackingAttributes","fetchUserAffiliateStats","loaderShowAction","loadIovation","setShowAutoCaptcha"])),{},{handleSubmit:function(){var e=this;return v()(k.a.mark((function t(){var r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=R.a.ioGetBlackbox(),e.bannerError=null,t.next=4,e.loginUser({params:J(J({user_handle:e.userHandle,password:e.password},r&&{iobb:r}),e.captchaResponse&&{"g-recaptcha-response":e.captchaResponse,render_captcha:e.showCaptcha})});case 4:if(e.isUserLoggedIn||!e.error){t.next=8;break}e.handleLoginError(e.error),t.next=13;break;case 8:if(e.updateFailedLoginAttemptCount(!0),!e.isUserLoggedIn){t.next=12;break}return t.next=12,e.fetchUserAffiliateStats({userId:e.userId});case 12:e.handleRedirect();case 13:case"end":return t.stop()}}),t)})))()},handleRedirect:function(){var e=this.$route.query&&this.$route.query["pmrd[url]"];F.a.isValidPmRdUrl(e,this.domain)?window.location.assign(R.a.generateUrlFromParamsAndAppendToUrl(e,{login:!0})):this.$router.push({name:"feed",query:{login:!0}})},handleLoginError:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.showCaptcha&&"undefined"!=typeof grecaptcha&&grecaptcha.reset(),e.errorType&&S()(t=["DisplayCaptchaError","SuspectedBotErrorV2"]).call(t,e.errorType)&&(r?this.$store.dispatch("setShowAutoCaptcha",!0):this.showCaptcha=!0);var a=e.userMessage;switch(e.errorType){case"PhoneUnverifiedError":var n=this.$route.query&&this.$route.query["pmrd[url]"];return this.$router.push({name:"phoneVerificationView",query:{"pmrd[url]":n}});case"PasswordAuthenticationError":this.updateFailedLoginAttemptCount(!1)>=2&&(this.showCaptcha=!0),a=this.invalidUsernamePasswordErrorMsg;break;case"AuthError":case"EmailTakenByGuestError":case"AuthenticationError":case"InvalidCredentialsError":a=r?this.defaultErrorMsg:a||this.invalidUsernamePasswordErrorMsg;break;case"SuspectedBotError":case"SuspectedBotErrorV2":case"DisplayCaptchaError":r?(this.$store.dispatch("setShowAutoCaptcha",!0),a=""):(this.showCaptcha=!0,a=this.displayCaptchaErrorMsg);break;default:a=a||this.$t("errorMessages.defaultError")}this.bannerError={errorType:e.errorType,userMessage:a}},handleCaptchaResponse:function(e){this.captchaResponse=e},updateFailedLoginAttemptCount:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.$jStorage.getItem("failed_login_attempt_count")||{};t&&this.userInfo?(e=0,r[this.userHandle]=e,r[this.userInfo.em]=e,r[this.userInfo.dh]=e,r[this.userInfo.uid]=e):(e=(r&&r[this.userHandle]?P()(r[this.userHandle]):0)+1,r[this.userHandle]=e);return this.$jStorage.setItem("failed_login_attempt_count",r),e},handleAutoCaptcha:function(){var e=arguments,t=this;return v()(k.a.mark((function r(){var a,n;return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:null,t.loaderShowAction(!0),r.next=4,t.$store.dispatch("$_auth/loginUser",{params:J({request_token:t.$route.query.token},a&&{"g-recaptcha-response":a,render_captcha:!0})});case 4:t.loaderShowAction(!1),(n=t.error)?t.handleLoginError(n,!0):t.handleRedirect();case 7:case"end":return r.stop()}}),r)})))()}}),metaInfo:function(){return{title:this.$t("common.logIn"),meta:[{description:N.a.getDomainBasedI18n(this.$t("login.metaDescription"),this.domain)}],script:[{src:O.a.SNARE,type:"text/javascript",async:!0,defer:!0}]}}},G=z,W=(r(3333),r(29)),X=Object(W.a)(G,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.externalEmailData?r("SelectEmail",{attrs:{externalEmailData:e.externalEmailData}}):r("div",[e.isCrossDomainVisitor&&!e.hideCrossDomainBanner?r("CrossDomainBanner",{attrs:{ipDomain:e.ipDomain},on:{close:function(t){e.hideCrossDomainBanner=!0}}}):e._e(),r("div",{staticClass:"card card--large form-card al--center login"},[r("h1",{staticClass:"ta--c m--b--7 h2"},[e._v("\n      "+e._s(e.$t("common.logIn"))+"\n    ")]),r("div",[e.isPhoneAuthenticationFlow?r("PhoneAuthentication",[r("template",{slot:"disclaimer"},[r("div",{staticClass:"m--v--6"},[r("i18n",{attrs:{path:"signup.disclaimer"}},[r("a",{staticClass:"td--ul tc--lg",attrs:{href:e.$pmRoutes.terms.baseUrl,place:"terms"}},[e._v(e._s(e.$t("common.poshmarkTerms")))]),r("a",{staticClass:"td--ul tc--lg",attrs:{href:e.$pmRoutes.privacy.baseUrl,place:"privacy"}},[e._v(e._s(e.$t("common.privacyPolicy")))])])],1)])],2):r("div",[r("SignUpIcons",{staticClass:"login__button-con",attrs:{hideEmail:!0,largeButtons:!1,btnContainerClass:(e.isMobile?"login__button--mobile":"")+" col-x24 login__button",showAppleSignIn:""}}),r("div",{staticClass:"divider_text caption"},[e._v("\n          "+e._s(e.$t("login.orFillOutWith"))+"\n        ")]),r("PmForm",{staticClass:"pmform no-label",attrs:{id:"email-login-form",submitAction:e.handleSubmit,buttonLoader:!0,bannerError:e.bannerError&&e.bannerError.userMessage,bannerErrorType:e.bannerError&&e.bannerError.errorType,etErrorBannerName:"signin_error",footerClass:"br--none p--t--0 jc--sb fw--w"}},[r("PmTextField",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"required form-control form-control-lg valid",attrs:{id:"login_form_username_email",placeholder:e.$t("common.inputUserNamePlaceholder"),autocorrect:"off",autocapitalize:"none",autocomplete:"username",dataTestValue:"login-form-username-email-field",name:"login_form[username_email]"},model:{value:e.userHandle,callback:function(t){e.userHandle="string"==typeof t?t.trim():t},expression:"userHandle"}}),r("PmTextField",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"required form-control form-control-lg valid",attrs:{id:"login_form_password",placeholder:e.$t("common.inputPasswordPlaceholder"),name:"login_form[password]",autocomplete:"current-password",dataTestValue:"login-form-password-field",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e.showCaptcha?r("AuthCaptcha",{staticClass:"m--b--5",on:{input:e.handleCaptchaResponse}}):e._e(),r("template",{slot:"footer"},[r("StaySignedIn",{staticClass:"stay_signed_in-login"}),r("a",{directives:[{name:"et-click",rawName:"v-et-click"}],staticClass:"caption tc--lg fw--med",attrs:{href:e.$pmRoutes.user.resetPwd.baseUrl,"data-et-name":"forgot_password"}},[e._v("\n              "+e._s(e.$t("common.forgotPwdTxt"))+"\n            ")]),r("button",{directives:[{name:"et-click",rawName:"v-et-click"}],staticClass:"btn btn--primary blue btn-primary",attrs:{type:"submit","data-pa-name":"login","data-et-name":"login"}},[e._v("\n              "+e._s(e.$t("common.login"))+"\n            ")])],1)],2)],1),r("div",{staticClass:"login__footer caption"},[r("i18n",{staticClass:"tc--lg",attrs:{path:"login.dontHaveAnAccount",tag:"span"}},[r("a",{directives:[{name:"et-click",rawName:"v-et-click"}],staticClass:"fw--med",attrs:{href:e.$pmRoutes.signup.defaultRoute.baseUrl,"data-et-name":"sign_up"}},[e._v("\n            "+e._s(e.$t("common.signUp"))+"\n          ")])])],1)],1)])],1)}),[],!1,null,null,null);t.default=X.exports}}]);